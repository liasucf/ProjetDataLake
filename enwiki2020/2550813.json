{
    "id": "2550813",
    "text": "Windows Preinstallation Environment (also known as Windows PE and WinPE) is a lightweight version of Windows used for the deployment of PCs, workstations, and servers, or troubleshooting an operating system while it is offline. It is intended to replace MS-DOS boot disks and can be booted via USB flash drive, PXE, iPXE, CD-ROM, or hard disk. Traditionally used by large corporations and OEMs (to preinstall Windows client operating systems on PCs during manufacturing), it is now widely available free of charge via Windows Assessment and Deployment Kit (WADK) (formerly Windows Automated Installation Kit (WAIK)). == Overview == WinPE was originally intended to be used only as a pre-installation platform for deploying Microsoft Windows operating systems, specifically to replace MS-DOS in this respect. WinPE has the following uses: * Deployment of workstations and servers in large corporations as well as pre- installation by system builders of workstations and servers to be sold to end users. * Recovery platform to run 32-bit or 64-bit recovery tools such as Winternals ERD Commander or Windows Recovery Environment (Windows RE). * Platform for running third-party 32-bit or 64-bit disk cloning utilities. The package can be used for developer testing or as a recovery CD/DVD for system administrators. Many customized WinPE boot CDs packaged with third-party applications for different uses are now available from volunteers via the Internet. The package can also be used as the base of a forensics investigation to either capture a disk image or run analysis tools without mounting any available disks and thus changing state. Version 2.0 introduced a number of improvements and extended the availability of WinPE to all customers, not just corporate enterprise customers by downloading and installing Microsoft's Windows Automated Installation Kit (WAIK). It was originally designed and built by a small team of engineers in Microsoft's Windows Deployment team, including Vijay Jayaseelan, Ryan Burkhardt, and Richard Bond. == Versions == The following versions are known to exist: {| class=wikitable ! Version !! Description |- | 1.0 || The first release of Windows Preinstallation Environment, built from Windows XP RTM |- | 1.1 || Built from Windows XP Professional with Service Pack 1 |- | 1.2 || Built from Windows Server 2003 RTM |- | 1.5 || Called Windows PE 2004; built from Windows XP Professional with Service Pack 2 |- | 1.6 || Called Windows PE 2005; built from Windows Server 2003 with Service Pack 1 |- | 2.0 || Built from the first edition of Windows Vista. This version differs from the other versions since it doesn't need the disc to load all the files. This means that the download is now 992 MB in size instead of 60 MB from the previous versions. It's possible to modify the default startup disc to have access to a few plug-ins like Windows Management Instrumentation, Windows Scripting Host, additional drivers and other 32-bit applications (or 64-bit applications for 64-bit versions). Other new features include the capability for a rewritable RAM disk since WinPE version 1.x only has a recordable RAM disk. |- | 2.1 || Built from Windows Server 2008 |- | 2.2 || Built from Windows Server 2008 SP2 |- | 3.0 || Built from Windows 7 code base. It is included in WAIK 2.0. |- | 3.1 || Built from Windows 7 SP1 code base. It is included in a WAIK supplementary update provided by Microsoft. |- | 4.0 || Built from Windows 8 code base. It is included in Windows ADK for Windows 8.0. |- | 5.0 || Built from Windows 8.1 code base. It is included in Windows ADK for Windows 8.1. |- | 5.1 || It is an update for version 5.0 that is applied manually. |- | 10.0.10240.16384 || Built from Windows 10 v1507 code base. It is included in Windows ADK for Windows 10. |- | 10.0.10586.0 || Built from Windows 10 v1511. It is included in Windows ADK for Windows 10 1511. |- | 10.0.14393.0 || Built from Windows 10 v1607 code base. It is included in Windows ADK for Windows 10 1607. |- | 10.0.15063.0 | Built from Windows 10 v1703 code base. |- | 10.0.16299.15 | Built from Windows 10 v1709 code base. |- | 10.0.17134.1 | Built from Windows 10 v1803 code base. |- | 10.0.17763.0 | Built from Windows 10 v1809 code base. |- | 10.0.18362.1 | Built from Windows 10 v1903 code base. |- |10.1.19041.1 |Built from Windows 10 v2004 code base. |} == Derivatives == === Windows Recovery Environment === alt= Windows Recovery Environment (WinRE) is a set of tools based on Windows PE to help diagnose and recover from serious errors which may be preventing Windows from booting successfully. Windows RE is installed along with Windows Vista and later, and may be booted from hard disks, optical media (such as an operating system installation disc) and PXE (e.g. Windows Deployment Services). A copy of Windows RE is included in the installation media of the aforementioned operating systems. It is a successor to Recovery Console. ==== Features ==== Windows RE features include: *Automatic Repair: Automatically finds and fixes boot errors in the Windows Vista Startup Process caused by issues such as corruption of the following components: Boot Configuration Data, disk and file system metadata, Master Boot Record, or Windows Registry, and issues caused by missing or damaged boot and system files, incompatible drivers, or damaged hardware. Prior to Windows 8, this mode was known as \"Startup Repair.\" The executable image for Automatic Repair is `startrep.exe` *System Restore: Same as the System Restore that is included in Windows, it allows a system's settings to be restored to those of a previous state. *System Image Recovery: Same as the Backup and Restore component of Windows, it allows restoring a previously created disk image. *Windows Memory Diagnostic Tool: Analyses the computer memory (RAM) for defects (not available on Windows 8 and later). The program does not run inside WinRE, but instead reboots the system and executes `memtest.exe` instead of loading the operating system. `memtest.exe` cannot be run inside Windows. *Windows Command Prompt: Gives command-line access to the file system, volumes and files. It can be used to run System File Checker (`sfc /scannow`) against an offline Windows installation and repair missing or corrupt files. Tools like `robocopy`, `diskpart` and `DISM` can be used to perform various system tasks like recovering or backing up files, managing partitions, and fix servicing-related issues respectively. In order to use the command prompt, the user must sign into an administrator account. Starting with Windows Server 2012/Windows 8, the following additional options are added: * \"Refresh\" or \"Reset\": Both re-install Windows from a copy of the operating system on the hard drive. The \"Refresh\" operation maintains files, settings, and Windows Store apps (but not other programs), while \"Reset\" performs a factory reset of Windows, optionally formatting the hard drive and performing disk wiping. The Reset function does not perform a full reinstall; it merely performs a factory reset from a WIM image inside a hidden recovery partition. It is possible to create a custom WIM image based on which a Reset is performed. * Startup Settings: Enforces a series of safe settings during the startup. Windows 10 adds the following: *Restore factory settings: Allows users who upgraded to Windows 10 to revert to their original operating system. * Go back to the previous build: Windows 10 is an operating system for which Microsoft occasionally releases newer builds. In the event that installation of a new build of Windows 10 becomes problematic, this option allows the user to revert to the previous build. Only appears if the previous build's files are not deleted. Volumes encrypted with Bitlocker can be mounted if a recovery key is available. Windows Recovery Environment can also be installed to a hard drive partition by OEMs, and customized with additional tools such as a separate system recovery tool for restoring the computer back to its original state. As of Windows Vista SP1, users can create their own bootable CD containing the recovery environment. ==== REAgentC ==== Windows includes the `REAgentC` command which is used to configure a Windows RE boot image and a push-button reset recovery image. It allows administration of recovery options and various customizations. The `REAgentC` tool can either be used on an offline Windows image or on a running Windows system.REAgentC command-line options | Microsoft Docs The command requires administrator privileges.How to enable Windows Recovery Environment (WinRE) on Windows 10 | Windows Central === Microsoft DaRT === Microsoft Diagnostics and Recovery Toolset (DaRT), sold as a part of Microsoft Desktop Optimization Pack, is yet another toolset based on Windows PE that performs diagnostic and recovery on an offline copy of Windows. It can manage files, edit Windows Registry, uninstall previously installed Windows updates, scan system for malware and restore deleted files. == See also == ; Concept *Live CD ;Related software *BartPE *nLite and vLite *WinBuilder *Windows To Go == References == == External links == * Windows PE Technical Reference * Install Windows PE to a USB drive * Windows Assessment and Deployment Kit for Windows 8.1 (contains Windows PE 5.0) Category:Windows administration Category:Microsoft software Category:Operating system distributions bootable from read-only media ",
    "title": "Windows Preinstallation Environment"
}