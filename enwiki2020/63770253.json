{
    "id": "63770253",
    "text": "In probability theory and statistics, the Dirichlet negative multinomial distribution is a multivariate distribution on the non-negative integers. It is a multivariate extension of the beta negative binomial distribution. It is also a generalization of the negative multinomial distribution (NM(k, p)) allowing for heterogeneity or overdispersion to the probability vector. It is used in quantitative marketing research to flexibly model the number of household transactions across several brands. If parameters of the Dirichlet distribution are \\boldsymbol{\\alpha}, and if : X \\mid p \\sim \\operatorname{NM}(x_0,\\mathbf{p}), where : \\mathbf{p} \\sim \\operatorname{Dir}(\\alpha_0,\\boldsymbol\\alpha), then the marginal distribution of X is a Dirichlet negative multinomial distribution: : X \\sim \\operatorname{DNM}(x_0,\\alpha_0,\\boldsymbol{\\alpha}). In the above, \\operatorname{NM}(x_0, \\mathbf{p}) is the negative multinomial distribution and \\operatorname{Dir}(\\alpha_0,\\boldsymbol\\alpha) is the Dirichlet distribution. ==Motivation== ===Dirichlet negative multinomial as a compound distribution=== The Dirichlet distribution is a conjugate distribution to the negative multinomial distribution. This fact leads to an analytically tractable compound distribution. For a random vector of category counts \\mathbf{x}=(x_1,\\dots,x_K), distributed according to a negative multinomial distribution, the compound distribution is obtained by integrating on the distribution for p which can be thought of as a random vector following a Dirichlet distribution: :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})=\\int_{\\mathbf{p}}\\Pr(\\mathbf{x}\\mid x_0, \\mathbf{p}) \\Pr(\\mathbf{p}\\mid\\alpha_0,\\boldsymbol{\\alpha})\\textrm{d}\\mathbf{p} :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})={\\frac{\\Gamma\\left(\\sum_{i=0}^m{x_i}\\right)}{\\Gamma(x_0)\\prod_{i=1}^m x_i!}} \\frac{1}{\\mathrm{B}(\\boldsymbol\\alpha)}\\int_{\\mathbf{p}} \\prod_{i=0}^m p_i^{x_i+\\alpha_i - 1}\\textrm{d}\\mathbf{p} which results in the following formula: :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})={\\frac{\\Gamma\\left(\\sum_{i=0}^m{x_i}\\right)}{\\Gamma(x_0)\\prod_{i=1}^m x_i!}} \\frac{{\\mathrm{B}}(\\mathbf{x_+}+\\boldsymbol\\alpha_+)}{\\mathrm{B}(\\boldsymbol\\alpha_+)} where \\mathbf{x_+} and \\boldsymbol\\alpha_+ are the m+1 dimensional vectors created by appending the scalars x_0 and \\alpha_0 to the m dimensional vectors \\mathbf{x} and \\boldsymbol\\alpha respectively and \\mathrm{B} is the multivariate version of the beta function. We can write this equation explicitly as :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})=x_0\\frac{\\Gamma(\\sum_{i=0}^m x_i)\\Gamma(\\sum_{i=0}^m \\alpha_i)}{\\Gamma(\\sum_{i=0}^m (x_i+\\alpha_i))} \\prod_{i=0}^m \\frac{\\Gamma(x_i+\\alpha_i)}{\\Gamma(x_i+1)\\Gamma(\\alpha_i)}. Alternative formulations exist. One convenient representationFarewell, Daniel & Farewell, Vernon. (2012). Dirichlet negative multinomial regression for overdispersed correlated count data. Biostatistics (Oxford, England). 14. 10.1093/biostatistics/kxs050. is :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})= \\frac{\\Gamma(x_\\bullet)}{\\Gamma(x_0)\\prod_{i=1}^m \\Gamma(x_i+1)} \\times \\frac{\\Gamma(\\alpha_\\bullet)}{\\prod_{i=0}^m \\Gamma(\\alpha_i)} \\times \\frac{\\prod_{i=0}^m \\Gamma(x_i+\\alpha_i)}{\\Gamma(x_\\bullet+\\alpha_\\bullet)} where x_\\bullet= x_0+x_1+ \\cdots + x_m and \\alpha_{\\bullet}= \\alpha_0+\\alpha_1+ \\cdots + \\alpha_m . This can also be written :\\Pr(\\mathbf{x}\\mid x_0, \\alpha_0, \\boldsymbol{\\alpha})=\\frac{\\mathrm{B}(x_\\bullet,\\alpha_\\bullet)}{\\mathrm{B}(x_0,\\alpha_0)}\\prod_{i=1}^m \\frac{\\Gamma(x_i+\\alpha_i)}{x_i! \\Gamma(\\alpha_i)}. ==Properties== ===Marginal distributions=== To obtain the marginal distribution over a subset of Dirichlet negative multinomial random variables, one only needs to drop the irrelevant \\alpha_i's (the variables that one wants to marginalize out) from the \\boldsymbol{\\alpha} vector. The joint distribution of the remaining random variates is \\mathrm{DNM}(x_0,\\alpha_0,\\boldsymbol{\\alpha_{-}}) where \\boldsymbol{\\alpha_{-}} is the vector with the removed \\alpha_i's. ===Conditional distributions=== If m-dimensional x is partitioned as follows : \\mathbf{x} = \\begin{bmatrix} \\mathbf{x}^{(1)} \\\\\\ \\mathbf{x}^{(2)} \\end{bmatrix} \\text{ with sizes }\\begin{bmatrix} q \\times 1 \\\\\\ (m-q) \\times 1 \\end{bmatrix} and accordingly \\boldsymbol{\\alpha} : \\boldsymbol\\alpha = \\begin{bmatrix} \\boldsymbol\\alpha^{(1)} \\\\\\ \\boldsymbol\\alpha^{(2)} \\end{bmatrix} \\text{ with sizes }\\begin{bmatrix} q \\times 1 \\\\\\ (m-q) \\times 1 \\end{bmatrix} then the conditional distribution of \\mathbf{x}^{(1)} on \\mathbf{x}^{(2)} is \\mathrm{DNM}(x_0^{\\prime},\\alpha_0^{\\prime},\\boldsymbol\\alpha^{(1)}) where : x_0^{\\prime} = x_0 + \\sum_{i=1}^{m-q} x_i^{(2)} and : \\alpha_0^{\\prime} = \\alpha_0 + \\sum_{i=1}^{m-q} \\alpha_i^{(2)} . That is, :\\Pr(\\mathbf{x}^{(1)}\\mid \\mathbf{x}^{(2)}, x_0, \\alpha_0, \\boldsymbol{\\alpha})= \\frac{\\mathrm{B}(x_\\bullet,\\alpha_\\bullet)}{\\mathrm{B}(x_0^{\\prime} ,\\alpha_0^{\\prime}) }\\prod_{i=1}^q\\frac{\\Gamma(x_i^{(1)}+\\alpha_i^{(1)})}{(x_i^{(1)}!)\\Gamma(\\alpha_i^{(1)})} ====Conditional on the sum==== The conditional distribution of a Dirichlet negative multinomial distribution on \\sum_{i=1}^m x_i = n is Dirichlet- multinomial distribution with parameters n and \\boldsymbol{\\alpha}. That is :\\Pr(\\mathbf{x} \\mid \\sum_{i=1}^m x_i =n, x_0, \\alpha_0, \\boldsymbol{\\alpha})= \\frac{n!\\Gamma\\left(\\sum_{i=1}^m \\alpha_i\\right)} {\\Gamma\\left(n+\\sum_{i=1}^m \\alpha_i\\right)}\\prod_{i=1}^m\\frac{\\Gamma(x_{i}+\\alpha_{i})}{x_{i}!\\Gamma(\\alpha_{i})} . Notice that the equation does not depend on x_0 or \\alpha_0. ===Correlation matrix=== For \\alpha_0>2 the entries of the correlation matrix are :\\rho(X_i,X_i) = 1. :\\rho(X_i,X_j) = \\frac{\\operatorname{cov}(X_i,X_j)}{\\sqrt{\\operatorname{var}(X_i)\\operatorname{var}(X_j)}} = \\sqrt{\\frac{\\alpha_i \\alpha_j}{(\\alpha_0+\\alpha_i-1)(\\alpha_0+\\alpha_j-1)}}. ===Heavy tailed=== The Dirichlet negative multinomial is a heavy tailed distribution. It does not have a finite mean for \\alpha_0 \\leq 1 and it has infinite covariance matrix for \\alpha_0 \\leq 2. It therefore has undefined moment generating function. ===Aggregation=== If :X = (X_1, \\ldots, X_m)\\sim\\operatorname{DNM}(x_0, \\alpha_0, \\alpha_1,\\ldots,\\alpha_m) then, if the random variables with positive subscripts i and j are dropped from the vector and replaced by their sum, :X' = (X_1, \\ldots, X_i + X_j, \\ldots, X_m)\\sim\\operatorname{DNM} \\left(x_0, \\alpha_0, \\alpha_1,\\ldots,\\alpha_i+\\alpha_j,\\ldots,\\alpha_m \\right). == Applications == ===Dirichlet negative multinomial as a urn model=== The Dirichlet negative multinomial can also be motivated by an urn model in the case when x_0 is a positive integer. Consider a sequence of independent and identically distributed multinomial trials, each of which has 1+m outcomes. Call one of the outcomes a \u201csuccess\u201d, and suppose it has probability p_0. The other m outcomes \u2013 called \"failures\" - have probabilities p_1,p_2, \\ldots, p_m. If the vector (x_1, x_2, \\cdots x_m) counts the m types of failures before the x_0 success is observed, then the (x_1, x_2, \\ldots, x_m) have negative mulitnomial distribution with parameters (x_0, p_1, \\ldots, p_m). If the parameters (p_0,p_1, \\ldots, p_m) are themselves sampled from a Dirichlet distribution with parameters (\\alpha_0, \\alpha_1, \\ldots, \\alpha_m), then the resulting distribution of (x_1, x_2, \\ldots, x_m) is Dirichlet negative multinomial. The resultant distribution has 2+m parameters. ==See also== * Beta negative binomial distribution * Negative multinomial distribution * Dirichlet-multinomial distribution == References == Category:Multivariate discrete distributions ",
    "title": "Dirichlet negative multinomial distribution"
}