{
    "id": "641132",
    "text": "The Gram\u2013Charlier A series (named in honor of J\u00f8rgen Pedersen Gram and Carl Charlier), and the Edgeworth series (named in honor of Francis Ysidro Edgeworth) are series that approximate a probability distribution in terms of its cumulants.Stuart, A., & Kendall, M. G. (1968). The advanced theory of statistics. Hafner Publishing Company. The series are the same; but, the arrangement of terms (and thus the accuracy of truncating the series) differ.Kolassa, J. E. (2006). Series approximation methods in statistics (Vol. 88). Springer Science & Business Media. The key idea of these expansions is to write the characteristic function of the distribution whose probability density function is to be approximated in terms of the characteristic function of a distribution with known and suitable properties, and to recover through the inverse Fourier transform. ==Gram\u2013Charlier A series== We examine a continuous random variable. Let \\hat{f} be the characteristic function of its distribution whose density function is , and \\kappa_r its cumulants. We expand in terms of a known distribution with probability density function , characteristic function \\hat{\\psi}, and cumulants \\gamma_r. The density is generally chosen to be that of the normal distribution, but other choices are possible as well. By the definition of the cumulants, we have (see Wallace, 1958) :\\hat{f}(t)= \\exp\\left[\\sum_{r=1}^\\infty\\kappa_r\\frac{(it)^r}{r!}\\right] and : \\hat{\\psi}(t)=\\exp\\left[\\sum_{r=1}^\\infty\\gamma_r\\frac{(it)^r}{r!}\\right], which gives the following formal identity: :\\hat{f}(t)=\\exp\\left[\\sum_{r=1}^\\infty(\\kappa_r-\\gamma_r)\\frac{(it)^r}{r!}\\right]\\hat{\\psi}(t)\\,. By the properties of the Fourier transform, (it)^r \\hat{\\psi}(t) is the Fourier transform of (-1)^r[D^r\\psi](-x), where is the differential operator with respect to . Thus, after changing x with -x on both sides of the equation, we find for the formal expansion :f(x) = \\exp\\left[\\sum_{r=1}^\\infty(\\kappa_r - \\gamma_r)\\frac{(-D)^r}{r!}\\right]\\psi(x)\\,. If is chosen as the normal density :\\phi(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left[-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right] with mean and variance as given by , that is, mean \\mu = \\kappa_1 and variance \\sigma^2 = \\kappa_2, then the expansion becomes :f(x) = \\exp\\left[\\sum_{r=3}^\\infty\\kappa_r\\frac{(-D)^r}{r!}\\right] \\phi(x), since \\gamma_r=0 for all > 2, as higher cumulants of the normal distribution are 0. By expanding the exponential and collecting terms according to the order of the derivatives, we arrive at the Gram\u2013Charlier A series. Such an expansion can be written compactly in terms of Bell polynomials as :\\exp\\left[\\sum_{r=3}^\\infty\\kappa_r\\frac{(-D)^r}{r!}\\right] = \\sum_{n=0}^\\infty B_n(0,0,\\kappa_3,\\ldots,\\kappa_n)\\frac{(-D)^n}{n!}. Since the n-th derivative of the Gaussian function \\phi is given in terms of Hermite polynomial as :\\phi^{(n)}(x) = \\frac{(-1)^n}{\\sigma^n} He_n \\left( \\frac{x-\\mu}{\\sigma} \\right) \\phi(x), this gives us the final expression of the Gram\u2013Charlier A series as : f(x) = \\phi(x) \\sum_{n=0}^\\infty \\frac{1}{n! \\sigma^n} B_n(0,0,\\kappa_3,\\ldots,\\kappa_n) He_n \\left( \\frac{x-\\mu}{\\sigma} \\right). Integrating the series gives us the cumulative distribution function : F(x) = \\int_{-\\infty}^x f(u) du = \\Phi(x) - \\phi(x) \\sum_{n=3}^\\infty \\frac{1}{n! \\sigma^{n-1}} B_n(0,0,\\kappa_3,\\ldots,\\kappa_n) He_{n-1} \\left( \\frac{x-\\mu}{\\sigma} \\right), where \\Phi is the CDF of the normal distribution. If we include only the first two correction terms to the normal distribution, we obtain : f(x) \\approx \\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left[-\\frac{(x-\\mu)^2}{2\\sigma^2}\\right]\\left[1+\\frac{\\kappa_3}{3!\\sigma^3}He_3\\left(\\frac{x-\\mu}{\\sigma}\\right)+\\frac{\\kappa_4}{4!\\sigma^4}He_4\\left(\\frac{x-\\mu}{\\sigma}\\right)\\right]\\,, with He_3(x)=x^3-3x and He_4(x)=x^4 - 6x^2 + 3. Note that this expression is not guaranteed to be positive, and is therefore not a valid probability distribution. The Gram\u2013Charlier A series diverges in many cases of interest\u2014it converges only if f(x) falls off faster than \\exp(-(x^2)/4) at infinity (Cram\u00e9r 1957). When it does not converge, the series is also not a true asymptotic expansion, because it is not possible to estimate the error of the expansion. For this reason, the Edgeworth series (see next section) is generally preferred over the Gram\u2013Charlier A series. ==The Edgeworth series== Edgeworth developed a similar expansion as an improvement to the central limit theorem.Hall, P. (2013). The bootstrap and Edgeworth expansion. Springer Science & Business Media. The advantage of the Edgeworth series is that the error is controlled, so that it is a true asymptotic expansion. Let \\\\{Z_i\\\\} be a sequence of independent and identically distributed random variables with mean \\mu and variance \\sigma^2, and let X_n be their standardized sums: :X_n = \\frac{1}{\\sqrt{n}} \\sum_{i=1}^n \\frac{Z_i - \\mu}{\\sigma}. Let F_n denote the cumulative distribution functions of the variables X_n. Then by the central limit theorem, : \\lim_{n\\to\\infty} F_n(x) = \\Phi(x) \\equiv \\int_{-\\infty}^x \\tfrac{1}{\\sqrt{2\\pi}}e^{-\\frac{1}{2}q^2}dq for every x, as long as the mean and variance are finite. Now assume that, in addition to having mean \\mu and variance \\sigma^2, the i.i.d. random variables Z_i have higher cumulants \\kappa_r. From the additivity and homogeneity properties of cumulants, the cumulants of X_n in terms of the cumulants of Z_i are for r \\geq 2, : \\kappa_r^{F_n} = \\frac{n \\kappa_r}{\\sigma^r n^{r/2}} = \\frac{\\lambda_r}{n^{r/2 - 1}} \\quad \\mathrm{where} \\quad \\lambda_r = \\frac{\\kappa_r}{\\sigma^r}. If we expand in terms of the standard normal distribution, that is, if we set :\\phi(x)=\\frac{1}{\\sqrt{2\\pi}}\\exp(-\\tfrac{1}{2}x^2), then the cumulant differences in the formal expression of the characteristic function \\hat{f}_n(t) of F_n are : \\kappa^{F_n}_1-\\gamma_1 = 0, : \\kappa^{F_n}_2-\\gamma_2 = 0, : \\kappa^{F_n}_r-\\gamma_r = \\frac{\\lambda_r}{n^{r/2-1}}; \\qquad r\\geq 3. The Gram\u2013Charlier A series for the density function of X_n is now : f_n(x) = \\phi(x) \\sum_{r=0}^\\infty \\frac{1}{r!} B_r \\left(0,0,\\frac{\\lambda_3}{n^{1/2}},\\ldots,\\frac{\\lambda_r}{n^{r/2-1}}\\right) He_r(x). The Edgeworth series is developed similarly to the Gram\u2013Charlier A series, only that now terms are collected according to powers of n. The coefficients of n-m/2 term can be obtained by collecting the monomials of the Bell polynomials corresponding to the integer partitions of m. Thus, we have the characteristic function as : \\hat{f}_n(t)=\\left[1+\\sum_{j=1}^\\infty \\frac{P_j(it)}{n^{j/2}}\\right] \\exp(-t^2/2)\\,, where P_j(x) is a polynomial of degree 3j. Again, after inverse Fourier transform, the density function f_n follows as : f_n(x) = \\phi(x) + \\sum_{j=1}^\\infty \\frac{P_j(-D)}{n^{j/2}} \\phi(x)\\,. Likewise, integrating the series, we obtain the distribution function : F_n(x) = \\Phi(x) + \\sum_{j=1}^\\infty \\frac{1}{n^{j/2}} \\frac{P_j(-D)}{D} \\phi(x)\\,. We can explicitly write the polynomial P_m(-D) as : P_m(-D) = \\sum \\prod_i \\frac{1}{k_i!} \\left(\\frac{\\lambda_{l_i}}{l_i!}\\right)^{k_i} (-D)^s, where the summation is over all the integer partitions of m such that \\sum_i i k_i = m and l_i = i+2 and s = \\sum_i k_i l_i. For example, if m = 3, then there are three ways to partition this number: 1 + 1 + 1 = 2 + 1 = 3. As such we need to examine three cases: * 1 + 1 + 1 = 1 \u00b7 k1, so we have k1 = 3, l1 = 3, and s = 9. * 1 + 2 = 1 \u00b7 k1 \\+ 2 \u00b7 k2, so we have k1 = 1, k2 = 1, l1 = 3, l2 = 4, and s = 7. * 3 = 3 \u00b7 k3, so we have k3 = 1, l3 = 5, and s = 5. Thus, the required polynomial is : \\begin{align} P_3(-D) &= \\frac{1}{3!} \\left(\\frac{\\lambda_3}{3!}\\right)^3 (-D)^9 + \\frac{1}{1! 1!} \\left(\\frac{\\lambda_3}{3!}\\right) \\left(\\frac{\\lambda_4}{4!}\\right) (-D)^7 + \\frac{1}{1!} \\left(\\frac{\\lambda_5}{5!}\\right) (-D)^5 \\\\\\ &= \\frac{\\lambda_3^3}{1296} (-D)^9 + \\frac{\\lambda_3 \\lambda_4}{144} (-D)^7 + \\frac{\\lambda_5}{120} (-D)^5. \\end{align} The first five terms of the expansion are :\\begin{align} f_n(x) &= \\phi(x) \\\\\\ &\\quad -\\frac{1}{n^{\\frac{1}{2}}}\\left(\\tfrac{1}{6}\\lambda_3\\,\\phi^{(3)}(x) \\right) \\\\\\ &\\quad +\\frac{1}{n}\\left(\\tfrac{1}{24}\\lambda_4\\,\\phi^{(4)}(x) + \\tfrac{1}{72}\\lambda_3^2\\,\\phi^{(6)}(x) \\right) \\\\\\ &\\quad -\\frac{1}{n^{\\frac{3}{2}}}\\left(\\tfrac{1}{120}\\lambda_5\\,\\phi^{(5)}(x) + \\tfrac{1}{144}\\lambda_3\\lambda_4\\,\\phi^{(7)}(x) + \\tfrac{1}{1296}\\lambda_3^3\\,\\phi^{(9)}(x)\\right) \\\\\\ &\\quad + \\frac{1}{n^2}\\left(\\tfrac{1}{720}\\lambda_6\\,\\phi^{(6)}(x) + \\left(\\tfrac{1}{1152}\\lambda_4^2 + \\tfrac{1}{720}\\lambda_3\\lambda_5\\right)\\phi^{(8)}(x) + \\tfrac{1}{1728}\\lambda_3^2\\lambda_4\\,\\phi^{(10)}(x) + \\tfrac{1}{31104}\\lambda_3^4\\,\\phi^{(12)}(x) \\right)\\\\\\ &\\quad + O \\left (n^{-\\frac{5}{2}} \\right ). \\end{align} Here, is the j-th derivative of at point x. Remembering that the derivatives of the density of the normal distribution are related to the normal density by \\phi^{(n)}(x) = (-1)^n He_n(x)\\phi(x), (where He_n is the Hermite polynomial of order n), this explains the alternative representations in terms of the density function. Blinnikov and Moessner (1998) have given a simple algorithm to calculate higher-order terms of the expansion. Note that in case of a lattice distributions (which have discrete values), the Edgeworth expansion must be adjusted to account for the discontinuous jumps between lattice points. ==Illustration: density of the sample mean of three \\chi^2 == Density of the sample mean of three chi2 variables. The chart compares the true density, the normal approximation, and two Edgeworth expansions. Take X_i \\sim \\chi^2(k=2), \\, i=1, 2, 3 \\, (n=3) and the sample mean \\bar X = \\frac{1}{3} \\sum_{i=1}^{3} X_i . We can use several distributions for \\bar X : * The exact distribution, which follows a gamma distribution: \\bar X \\sim \\mathrm{Gamma}\\left(\\alpha=n\\cdot k /2, \\theta= 2/n \\right)=\\mathrm{Gamma}\\left(\\alpha=3, \\theta= 2/3 \\right). * The asymptotic normal distribution: \\bar X \\xrightarrow{n \\to \\infty} N(k, 2\\cdot k /n ) = N(2, 4/3 ). * Two Edgeworth expansions, of degrees 2 and 3. ==Discussion of results== * For finite samples, an Edgeworth expansion is not guaranteed to be a proper probability distribution as the CDF values at some points may go beyond [0,1]. * They guarantee (asymptotically) absolute errors, but relative errors can be easily assessed by comparing the leading Edgeworth term in the remainder with the overall leading term. ==See also== * Cornish\u2013Fisher expansion * Edgeworth binomial tree ==References== ==Further reading== * H. Cram\u00e9r. (1957). Mathematical Methods of Statistics. Princeton University Press, Princeton. * * M. Kendall & A. Stuart. (1977), The advanced theory of statistics, Vol 1: Distribution theory, 4th Edition, Macmillan, New York. * P. McCullagh (1987). Tensor Methods in Statistics. Chapman and Hall, London. * D. R. Cox and O. E. Barndorff-Nielsen (1989). Asymptotic Techniques for Use in Statistics. Chapman and Hall, London. * P. Hall (1992). The Bootstrap and Edgeworth Expansion. Springer, New York. * * * * J. E. Kolassa (2006). Series Approximation Methods in Statistics (3rd ed.). (Lecture Notes in Statistics #88). Springer, New York. Category:Mathematical series Category:Statistical approximations ",
    "title": "Edgeworth series"
}