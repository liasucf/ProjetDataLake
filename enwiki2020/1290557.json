{
    "id": "1290557",
    "text": "Phase correlation is an approach to estimate the relative translative offset between two similar images (digital image correlation) or other data sets. It is commonly used in image registration and relies on a frequency-domain representation of the data, usually calculated by fast Fourier transforms. The term is applied particularly to a subset of cross-correlation techniques that isolate the phase information from the Fourier-space representation of the cross-correlogram. == Example == The following image demonstrates the usage of phase correlation to determine relative translative movement between two images corrupted by independent Gaussian noise. The image was translated by (30,33) pixels. Accordingly, one can clearly see a peak in the phase- correlation representation at approximately (30,33). Image:Phase correlation.png == Method == Given two input images \\ g_a and \\ g_b: Apply a window function (e.g., a Hamming window) on both images to reduce edge effects (this may be optional depending on the image characteristics). Then, calculate the discrete 2D Fourier transform of both images. :\\ \\mathbf{G}_a = \\mathcal{F}\\\\{g_a\\\\}, \\; \\mathbf{G}_b = \\mathcal{F}\\\\{g_b\\\\} Calculate the cross-power spectrum by taking the complex conjugate of the second result, multiplying the Fourier transforms together elementwise, and normalizing this product elementwise. :\\ R = \\frac{ \\mathbf{G}_a \\circ \\mathbf{G}_b^*}{|\\mathbf{G}_a \\circ \\mathbf{G}_b^*|} Where \\circ is the Hadamard product (entry-wise product) and the absolute values are taken entry- wise as well. Written out entry-wise for element index (j,k): :\\ R_{jk} = \\frac{ G_{a,jk} \\cdot G_{b,jk}^*}{|G_{a,jk} \\cdot G_{b,jk}^* |} Obtain the normalized cross-correlation by applying the inverse Fourier transform. :\\ r = \\mathcal{F}^{-1}\\\\{R\\\\} Determine the location of the peak in \\ r. :\\ (\\Delta x, \\Delta y) = \\arg \\max_{(x, y)}\\\\{r\\\\} Commonly, interpolation methods are used to estimate the peak location in the cross-correlogram to non-integer values, despite the fact that the data are discrete, and this procedure is often termed 'subpixel registration'. A large variety of subpixel interpolation methods are given in the technical literature. Common peak interpolation methods such as parabolic interpolation have been used, and the OpenCV computer vision package uses a centroid-based method, though these generally have inferior accuracy compared to more sophisticated methods. Because the Fourier representation of the data has already been computed, it is especially convenient to use the Fourier shift theorem with real-valued (sub-integer) shifts for this purpose, which essentially interpolates using the sinusoidal basis functions of the Fourier transform. An especially popular FT-based estimator is given by Foroosh et al.H. Foroosh (Shekarforoush), J.B. Zerubia, and M. Berthod, \"Extension of Phase Correlation to Subpixel Registration,\" IEEE Transactions on Image Processing, V. 11, No. 3, Mar. 2002, pp. 188-200. In this method, the subpixel peak location is approximated by a simple formula involving peak pixel value and the values of its nearest neighbors, where r_{(0,0)} is the peak value and r_{(1,0)} is the nearest neighbor in the x direction (assuming, as in most approaches, that the integer shift has already been found and the comparand images differ only by a subpixel shift). :\\ \\Delta x = \\frac{ r_{(1,0)} }{r_{(1,0)} \\plusmn r_{(0,0)}} The Foroosh et al. method is quite fast compared to most methods, though it is not always the most accurate. Some methods shift the peak in Fourier space and apply non-linear optimization to maximize the correlogram peak, but these tend to be very slow since they must apply an inverse Fourier transform or its equivalent in the objective function.E.g. M. Sj\u00f6dahl and L.R. Benckert, \"Electronic speckle photography: analysis of an algorithm giving the displacement with subpixel accuracy,\" Appl Opt. 1993 May 1;32(13):2278-84. doi: 10.1364/AO.32.002278 It is also possible to infer the peak location from phase characteristics in Fourier space without the inverse transformation, as noted by Stone.Harold S. Stone, \"A Fast Direct Fourier-Based Algorithm for Subpixel Registration of Images\", IEEE Transactions on Geoscience and Remote Sensing, V. 39, No. 10, Oct. 2001, pp.2235-2242 These methods usually use a linear least squares (LLS) fit of the phase angles to a planar model. The long latency of the phase angle computation in these methods is a disadvantage, but the speed can sometimes be comparable to the Foroosh et al. method depending on the image size. They often compare favorably in speed to the multiple iterations of extremely slow objective functions in iterative non-linear methods. Since all subpixel shift computation methods are fundamentally interpolative, the performance of a particular method depends on how well the underlying data conform to the assumptions in the interpolator. This fact also may limit the usefulness of high numerical accuracy in an algorithm, since the uncertainty due to interpolation method choice may be larger than any numerical or approximation error in the particular method. Subpixel methods are also particularly sensitive to noise in the images, and the utility of a particular algorithm is distinguished not only by its speed and accuracy but its resilience to the particular types of noise in the application. == Rationale == The method is based on the Fourier shift theorem. Let the two images \\ g_a and \\ g_b be circularly-shifted versions of each other: :\\ g_b(x,y) \\ \\stackrel{\\mathrm{def}}{=}\\ g_a((x - \\Delta x) \\bmod M, (y - \\Delta y) \\bmod N) (where the images are \\ M \\times N in size). Then, the discrete Fourier transforms of the images will be shifted relatively in phase: :\\mathbf{G}_b(u,v) = \\mathbf{G}_a(u,v) e^{-2 \\pi i (\\frac{u \\Delta x}{M} + \\frac{v \\Delta y}{N}) } One can then calculate the normalized cross-power spectrum to factor out the phase difference: : \\begin{align} R(u,v) &= \\frac{ \\mathbf{G}_a \\mathbf{G}_b^*}{|\\mathbf{G}_a \\mathbf{G}_b^* |} \\\\\\ &= \\frac{ \\mathbf{G}_a \\mathbf{G}_a^* e^{2 \\pi i (\\frac{u \\Delta x}{M} + \\frac{v \\Delta y}{N}) }}{|\\mathbf{G}_a \\mathbf{G}_a^* e^{2 \\pi i (\\frac{u \\Delta x}{M} + \\frac{v \\Delta y}{N}) }|} \\\\\\ &= \\frac{ \\mathbf{G}_a \\mathbf{G}_a^* e^{2 \\pi i (\\frac{u \\Delta x}{M} + \\frac{v \\Delta y}{N}) }}{|\\mathbf{G}_a \\mathbf{G}_a^*|} \\\\\\ &= e^{2 \\pi i (\\frac{u \\Delta x}{M} + \\frac{v \\Delta y}{N}) } \\end{align} since the magnitude of an imaginary exponential always is one, and the phase of \\ \\mathbf{G}_a \\mathbf{G}_a^* always is zero. The inverse Fourier transform of a complex exponential is a Kronecker delta, i.e. a single peak: :\\ r(x,y) = \\delta(x + \\Delta x, y + \\Delta y) This result could have been obtained by calculating the cross correlation directly. The advantage of this method is that the discrete Fourier transform and its inverse can be performed using the fast Fourier transform, which is much faster than correlation for large images. === Benefits === Unlike many spatial-domain algorithms, the phase correlation method is resilient to noise, occlusions, and other defects typical of medical or satellite images. The method can be extended to determine rotation and scaling differences between two images by first converting the images to log-polar coordinates. Due to properties of the Fourier transform, the rotation and scaling parameters can be determined in a manner invariant to translation.E. De Castro and C. Morandi \"Registration of Translated and Rotated Images Using Finite Fourier Transforms\", IEEE Transactions on Pattern Analysis and Machine Intelligence, Sept. 1987B. S Reddy and B. N. Chatterji, \u201cAn FFT-based technique for translation, rotation, and scale-invariant image registration\u201d, IEEE Transactions on Image Processing 5, no. 8 (1996): 1266\u20131271. === Limitations === In practice, it is more likely that \\ g_b will be a simple linear shift of \\ g_a, rather than a circular shift as required by the explanation above. In such cases, \\ r will not be a simple delta function, which will reduce the performance of the method. In such cases, a window function (such as a Gaussian or Tukey window) should be employed during the Fourier transform to reduce edge effects, or the images should be zero padded so that the edge effects can be ignored. If the images consist of a flat background, with all detail situated away from the edges, then a linear shift will be equivalent to a circular shift, and the above derivation will hold exactly. The peak can be sharpened by using edge or vector correlation.http://www.jprr.org/index.php/jprr/article/viewFile/355/148 For periodic images (such as a chessboard), phase correlation may yield ambiguous results with several peaks in the resulting output. == Applications == Phase correlation is the preferred method for television standards conversion, as it leaves the fewest artifacts. == See also == General * Cross correlation * Scaled Correlation Television * Television standards conversion * Reverse Standards Conversion == References == == External links == *Using Matlab to perform normalized cross-correlation on images Category:Computer vision ",
    "title": "Phase correlation"
}