{
    "id": "45177",
    "text": "In probability theory and statistics, the negative binomial distribution is a discrete probability distribution that models the number of failures in a sequence of independent and identically distributed Bernoulli trials before a specified (non-random) number of successes (denoted r) occurs. For example, we can define rolling a 6 on a die as a failure, and rolling any other number as a success, and ask how many successful rolls will occur before we see the third failure (r = 3). In such a case, the probability distribution of the number of non-6s that appear will be a negative binomial distribution. The Pascal distribution (after Blaise Pascal) and Polya distribution (for George P\u00f3lya) are special cases of the negative binomial distribution. A convention among engineers, climatologists, and others is to use \"negative binomial\" or \"Pascal\" for the case of an integer-valued stopping-time parameter r, and use \"Polya\" for the real-valued case. For occurrences of associated discrete events, like tornado outbreaks, the Polya distributions can be used to give more accurate models than the Poisson distribution by allowing the mean and variance to be different, unlike the Poisson. The negative binomial distribution has a variance \\mu (1 + \\mu / r), with the distribution becoming identical to Poisson in the limit r\\to\\infty for a given mean \\mu. This can make the distribution a useful overdispersed alternative to the Poisson distribution, for example for a robust modification of Poisson regression. In epidemiology it has been used to model disease transmission for infectious diseases where the likely number of onward infections may vary considerably from individual to individual and from setting to setting.eg: J.O. Lloyd- Smith, S.J. Schreiber, P.E. Kopp, and W.M. Getz (2005), Superspreading and the effect of individual variation on disease emergence, Nature, 438, 355\u2013359. The overdispersion parameter is usually denoted by the letter k in epidemiology, rather than r as here. More generally it may be appropriate where events have positively correlated occurrences causing a larger variance than if the occurrences were independent, due to a positive covariance term. The term \"negative binomial\" is likely due to the fact that a certain binomial coefficient that appears in the formula for the probability mass function of the distribution can be written more simply with negative numbers. ==Definitions== Suppose there is a sequence of independent Bernoulli trials. Thus, each trial has two potential outcomes called \"success\" and \"failure\". In each trial the probability of success is p and of failure is (1 \u2212 p). We are observing this sequence until a predefined number r of successes have occurred. Then the random number of failures we have seen, X, will have the negative binomial (or Pascal) distribution: : X\\sim\\operatorname{NB}(r, p) When applied to real-world problems, outcomes of success and failure may or may not be outcomes we ordinarily view as good and bad, respectively. Suppose we used the negative binomial distribution to model the number of days a certain machine works before it breaks down. In this case \"failure\" would be the result on a day when the machine worked properly, whereas a breakdown would be a \"success\". If we used the negative binomial distribution to model the number of goal attempts an athlete makes before scoring r goals, though, then each unsuccessful attempt would be a \"failure\", and scoring a goal would be \"success\". If we are tossing a coin, then the negative binomial distribution can give the number of tails (\"failures\") we are likely to encounter before we encounter a certain number of heads (\"successes\"). In the probability mass function below, p is the probability of success, and (1 \u2212 p) is the probability of failure. ===Probability mass function=== The probability mass function of the negative binomial distribution is : f(k; r, p) \\equiv \\Pr(X = k) = \\binom{k+r-1}{r-1} (1-p)^kp^r where r is the number of successes, k is the number of failures, and p is the probability of success. Here the quantity in parentheses is the binomial coefficient, and is equal to : \\binom{k+r-1}{r-1} = \\frac{(k+r-1)!}{(r-1)!\\,(k)!} = \\frac{(k+r-1)(k+r-2)\\dotsm(r)}{(k)!}. There are k failures chosen from k+r-1 samples rather than k+r because the last of the k+r samples is by definition a success. This quantity can alternatively be written in the following manner, explaining the name \"negative binomial\": : \\begin{align} & \\frac{(k+r-1)\\dotsm(r)}{(k)!} \\\\\\\\[6pt] = {} & (-1)^k \\frac{(-r)(-r-1)(-r-2)\\dotsm(-r-k+1)}{(k)!} = (-1)^k\\binom{-r}{k}. \\end{align} Note that by the last expression and the binomial series, for every and q=1-p, : p^{-r} = (1-q)^{-r} = \\sum_{k=0}^\\infty \\binom{-r}{k}(-q)^k = \\sum_{k=0}^\\infty \\binom{k+r-1}{k}q^k hence the terms of the probability mass function indeed add up to one as below. : \\sum_{k=0}^\\infty \\binom{k+r-1}{k}(1-p)^kp^r = p^{-r}p^r = 1 To understand the above definition of the probability mass function, note that the probability for every specific sequence of r successes and k failures is , because the outcomes of the k + r trials are supposed to happen independently. Since the rth success always comes last, it remains to choose the k trials with failures out of the remaining k + r \u2212 1 trials. The above binomial coefficient, due to its combinatorial interpretation, gives precisely the number of all these sequences of length k + r \u2212 1\\. ===Cumulative distribution function=== The cumulative distribution function can be expressed in terms of the regularized incomplete beta function: : F(k; r, p) \\equiv \\Pr(X\\le k) = 1 - I_{p}(k+1, r) = I_{1-p}(r,k+1). It can also be expressed in terms of the cumulative distribution function of the binomial distribution:Morris K W (1963),A note on direct and inverse sampling, Biometrika, 50, 544--545. : F(k; r, p) = F_{binomial}(k;n=k+r,p). ===Alternative formulations=== Some sources may define the negative binomial distribution slightly differently from the primary one here. The most common variations are where the random variable X is counting different things. These variations can be seen in the table here: {| class=\"wikitable\" | |X is counting... |Probability mass function |Formula |Alternate formula (using equivalent binomial) |Alternate formula (simplified using: n=k+r ) |Support |- |1 |k failures, given r successes |f(k; r, p) \\equiv \\Pr(X = k) = |\\binom{k+r-1}{k} p^r(1-p)^k |\\binom{k+r-1}{r-1} p^r(1-p)^k SAS Institute, \"Negative Binomial Distribution\", SAS(R) 9.4 Functions and CALL Routines: Reference, Fourth Edition, SAS Institute, Cary, NC, 2016. | rowspan=\"2\" |\\binom{n-1}{k} p^r(1-p)^k |\\text{for }k = 0, 1, 2, \\ldots |- |2 |n trials, given r successes |f(n; r, p) \\equiv \\Pr(X = n) = |\\binom{n-1}{r-1} p^r(1-p)^{n-r} |\\binom{n-1}{n-r} p^r(1-p)^{n-r} |\\text{for }n = r, r+1, r+2, \\dotsc |- |3 |r successes, given n trials |f(r; n, p) \\equiv \\Pr(X = r) = | colspan=\"3\" |This is the binomial distribution: \\binom{n}{r} p^r(1-p)^{n-r} |\\text{for }r = 0, 1, 2, \\dotsc, n |} Each of these definitions of the negative binomial distribution can be expressed in slightly different but equivalent ways. The first alternative formulation is simply an equivalent form of the binomial coefficient, that is: \\binom ab = \\binom a{a-b} \\quad \\text{for }\\ 0\\leq b\\leq a. The second alternate formulation somewhat simplifies the expression by recognizing that the total number of trials is simply the number of successes and failures, that is: n=r+k . These second formulations may be more intuitive to understand, however they are perhaps less practical as they have more terms. # The definition where X is the number of k failures that occur for a given number of r successes. This definition is very similar to the primary definition used in this article, only that k successes and r failures are switched when considering what is being counted and what is given. Note however, that p still refers to the probability of \"success\". # The definition where X is the number of n trials that occur for a given number of r successes. This definition is very similar to definition #2, only that r successes is given instead of k failures. Note however, that p still refers to the probability of \"success\". * The definition of the negative binomial distribution can be extended to the case where the parameter r can take on a positive real value. Although it is impossible to visualize a non- integer number of \"failures\", we can still formally define the distribution through its probability mass function. The problem of extending the definition to real-valued (positive) r boils down to extending the binomial coefficient to its real-valued counterpart, based on the gamma function: :: \\binom{k+r-1}{k} = \\frac{(k+r-1)(k+r-2)\\dotsm(r)}{k!} = \\frac{\\Gamma(k+r)}{k!\\,\\Gamma(r)} : After substituting this expression in the original definition, we say that X has a negative binomial (or P\u00f3lya) distribution if it has a probability mass function: :: f(k; r, p) \\equiv \\Pr(X = k) = \\frac{\\Gamma(k+r)}{k!\\,\\Gamma(r)} (1-p)^r p^k \\quad\\text{for }k = 0, 1, 2, \\dotsc : Here r is a real, positive number. In negative binomial regression, the distribution is specified in terms of its mean, m=\\frac{pr}{1-p}, which is then related to explanatory variables as in linear regression or other generalized linear models. From the expression for the mean m, one can derive p=\\frac{m}{m+r} and 1-p=\\frac{r}{m+r}. Then, substituting these expressions in the one for the probability mass function when r is real-valued, yields this parametrization of the probability mass function in terms of m: : \\Pr(X = k) = \\frac{\\Gamma(r+k)}{k! \\, \\Gamma(r)} \\left(\\frac{r}{r+m}\\right)^r \\left(\\frac{m}{r+m}\\right)^k \\quad\\text{for }k = 0, 1, 2, \\dotsc The variance can then be written as m+\\frac{m^2}{r}. Some authors prefer to set \\alpha = \\frac{1}{r}, and express the variance as m+\\alpha m^2. In this context, and depending on the author, either the parameter r or its reciprocal \u03b1 is referred to as the \"dispersion parameter\", \"shape parameter\" or \"clustering coefficient\", or the \"heterogeneity\" or \"aggregation\" parameter. The term \"aggregation\" is particularly used in ecology when describing counts of individual organisms. Decrease of the aggregation parameter r towards zero corresponds to increasing aggregation of the organisms; increase of r towards infinity corresponds to absence of aggregation, as can be described by Poisson regression. * Sometimes the distribution is parameterized in terms of its mean \u03bc and variance \u03c32: :: \\begin{align} & p =\\frac{\\sigma^2 - \\mu}{\\sigma^2}, \\\\\\\\[6pt] & r =\\frac{\\mu^2}{\\sigma^2-\\mu}, \\\\\\\\[3pt] & \\Pr(X=k) = {k+\\frac{\\mu^2}{\\sigma^2-\\mu}-1 \\choose k} \\left(\\frac{\\sigma^2-\\mu}{\\sigma^2}\\right)^k \\left(\\frac \\mu {\\sigma^2}\\right)^{\\mu^2/(\\sigma^2-\\mu)}. \\end{align} ===Examples=== ====Selling candy==== Pat Collis is required to sell candy bars to raise money for the 6th grade field trip. There are thirty houses in the neighborhood, and Pat is not supposed to return home until five candy bars have been sold. So the child goes door to door, selling candy bars. At each house, there is a 0.6 probability of selling one candy bar and a 0.4 probability of selling nothing. What's the probability of selling the last candy bar at the nth house? Successfully selling candy enough times is what defines our stopping criterion (as opposed to failing to sell it), so k in this case represents the number of failures and r represents the number of successes. Recall that the NegBin(r, p) distribution describes the probability of k failures and r successes in k + r Bernoulli(p) trials with success on the last trial. Selling five candy bars means getting five successes. The number of trials (i.e. houses) this takes is therefore k + 5 = n. The random variable we are interested in is the number of houses, so we substitute k = n \u2212 5 into a NegBin(5, 0.4) mass function and obtain the following mass function of the distribution of houses (for n \u2265 5): : f(n) = {(n-5) + 5 - 1 \\choose n-5} \\; (1-0.4)^5 \\; 0.4^{n-5} = {n-1 \\choose n-5} \\; 3^5 \\; \\frac{2^{n-5}}{5^n}. What's the probability that Pat finishes on the tenth house? : f(10) = 0.1003290624. \\, What's the probability that Pat finishes on or before reaching the eighth house? To finish on or before the eighth house, Pat must finish at the fifth, sixth, seventh, or eighth house. Sum those probabilities: : f(5) = 0.07776 \\, : f(6) = 0.15552 \\, : f(7) = 0.18662 \\, : f(8) = 0.17418 \\, :\\sum_{j=5}^8 f(j) = 0.59408. What's the probability that Pat exhausts all 30 houses in the neighborhood? This can be expressed as the probability that Pat does not finish on the fifth through the thirtieth house: :1-\\sum_{j=5}^{30} f(j) = 1 - I_{0.4}(5, 30-5+1) \\approx 1 - 0.99999342 = 0.00000658. Because of the rather high probability that Pat will sell to each house (60 percent), the probability of her NOT fulfilling her quest is vanishingly slim. ====Length of hospital stay==== Hospital length of stay is an example of real-world data that can be modelled well with a negative binomial distribution. ==Properties== ===Expectation=== The expected total number of successes in a negative binomial distribution with parameters is rp/(1 \u2212 p). To see this, imagine an experiment simulating the negative binomial is performed many times. That is, a set of trials is performed until failures are obtained, then another set of trials, and then another etc. Write down the number of trials performed in each experiment: and set . Now we would expect about successes in total. Say the experiment was performed times. Then there are failures in total. So we would expect , so . See that is just the average number of trials per experiment. That is what we mean by \"expectation\". The average number of successes per experiment is . This agrees with the mean given in the box on the right-hand side of this page. === Variance === When counting the number of successes given the number r of failures, the variance is rp/(1 \u2212 p)2. When counting the number of failures before the r-th success, the variance is r(1 \u2212 p)/p2. ===Relation to the binomial theorem=== Suppose Y is a random variable with a binomial distribution with parameters n and p. Assume p + q = 1, with p, q \u2265 0, then :1=1^n=(p+q)^n. Using Newton's binomial theorem, this can equally be written as: :(p+q)^n=\\sum_{k=0}^\\infty {n \\choose k} p^k q^{n-k}, in which the upper bound of summation is infinite. In this case, the binomial coefficient : {n \\choose k}={n(n-1)(n-2)\\cdots(n-k+1) \\over k! }. is defined when n is a real number, instead of just a positive integer. But in our case of the binomial distribution it is zero when k > n. We can then say, for example : (p+q)^{8.3}=\\sum_{k=0}^\\infty {8.3 \\choose k} p^k q^{8.3 - k}. Now suppose r > 0 and we use a negative exponent: :1=p^r\\cdot p^{-r}=p^r (1-q)^{-r}=p^r \\sum_{k=0}^\\infty {-r \\choose k} (-q)^k. Then all of the terms are positive, and the term :p^r {-r \\choose k} (-q)^k is just the probability that the number of failures before the rth success is equal to k, provided r is an integer. (If r is a negative non-integer, so that the exponent is a positive non-integer, then some of the terms in the sum above are negative, so we do not have a probability distribution on the set of all nonnegative integers.) Now we also allow non-integer values of r. Then we have a proper negative binomial distribution, which is a generalization of the Pascal distribution, which coincides with the Pascal distribution when r happens to be a positive integer. Recall from above that :The sum of independent negative-binomially distributed random variables r1 and r2 with the same value for parameter p is negative-binomially distributed with the same p but with r-value r1 + r2. This property persists when the definition is thus generalized, and affords a quick way to see that the negative binomial distribution is infinitely divisible. === Recurrence relation === The following recurrence relation holds: : \\begin{cases} (k+1) \\Pr (k+1)-p \\Pr (k) (k+r)=0, \\\\\\\\[5pt] \\Pr (0)=(1-p)^r \\end{cases} ==Related distributions== * The geometric distribution (on { 0, 1, 2, 3, ... }) is a special case of the negative binomial distribution, with ::\\operatorname{Geom}(p) = \\operatorname{NB}(1,\\, 1-p).\\, * The negative binomial distribution is a special case of the discrete phase-type distribution. * The negative binomial distribution is a special case of discrete Compound Poisson distribution. ===Poisson distribution=== Consider a sequence of negative binomial random variables where the stopping parameter r goes to infinity, whereas the probability of success in each trial, p, goes to zero in such a way as to keep the mean of the distribution constant. Denoting this mean as \u03bb, the parameter p will be p = \u03bb/(r + \u03bb) : \\lambda = r\\,\\frac{p}{1- p} \\quad \\Rightarrow \\quad p = \\frac{\\lambda}{r+\\lambda}. Under this parametrization the probability mass function will be : f(k; r, p) = \\frac{\\Gamma(k+r)}{k!\\cdot\\Gamma(r)}p^k(1-p)^r = \\frac{\\lambda^k}{k!} \\cdot \\frac{\\Gamma(r+k)}{\\Gamma(r)\\;(r+\\lambda)^k} \\cdot \\frac{1}{\\left(1+\\frac{\\lambda}{r}\\right)^{r}} Now if we consider the limit as r \u2192 \u221e, the second factor will converge to one, and the third to the exponent function: : \\lim_{r\\to\\infty} f(k; r, p) = \\frac{\\lambda^k}{k!} \\cdot 1 \\cdot \\frac{1}{e^\\lambda}, which is the mass function of a Poisson- distributed random variable with expected value \u03bb. In other words, the alternatively parameterized negative binomial distribution converges to the Poisson distribution and r controls the deviation from the Poisson. This makes the negative binomial distribution suitable as a robust alternative to the Poisson, which approaches the Poisson for large r, but which has larger variance than the Poisson for small r. : \\operatorname{Poisson}(\\lambda) = \\lim_{r \\to \\infty} \\operatorname{NB} \\left(r, \\frac{\\lambda}{r + \\lambda}\\right). ===Gamma\u2013Poisson mixture=== The negative binomial distribution also arises as a continuous mixture of Poisson distributions (i.e. a compound probability distribution) where the mixing distribution of the Poisson rate is a gamma distribution. That is, we can view the negative binomial as a distribution, where \u03bb is itself a random variable, distributed as a gamma distribution with shape = r and scale \u03b8 = or correspondingly rate . To display the intuition behind this statement, consider two independent Poisson processes, \u201cSuccess\u201d and \u201cFailure\u201d, with intensities p and 1 \u2212 p. Together, the Success and Failure processes are equivalent to a single Poisson process of intensity 1, where an occurrence of the process is a success if a corresponding independent coin toss comes up heads with probability p; otherwise, it is a failure. If r is a counting number, the coin tosses show that the count of successes before the rth failure follows a negative binomial distribution with parameters r and p. The count is also, however, the count of the Success Poisson process at the random time T of the rth occurrence in the Failure Poisson process. The Success count follows a Poisson distribution with mean pT, where T is the waiting time for r occurrences in a Poisson process of intensity 1 \u2212 p, i.e., T is gamma-distributed with shape parameter r and intensity 1 \u2212 p. Thus, the negative binomial distribution is equivalent to a Poisson distribution with mean pT, where the random variate T is gamma- distributed with shape parameter r and intensity . The preceding paragraph follows, because \u03bb = pT is gamma-distributed with shape parameter r and intensity . The following formal derivation (which does not depend on r being a counting number) confirms the intuition. : \\begin{align} f(k; r, p) & = \\int_0^\\infty f_{\\operatorname{Poisson}(\\lambda)}(k) \\cdot f_{\\operatorname{Gamma}\\left(r,\\, \\frac{1-p}{p}\\right)}(\\lambda) \\; \\mathrm{d}\\lambda \\\\\\\\[8pt] & = \\int_0^\\infty \\frac{\\lambda^k}{k!} e^{-\\lambda} \\cdot \\lambda^{r-1}\\frac{e^{-\\lambda (1-p)/p}}{\\big(\\frac{p}{1-p}\\big)^r\\,\\Gamma(r)} \\; \\mathrm{d}\\lambda \\\\\\\\[8pt] & = \\frac{(1-p)^r p^{-r}}{k!\\,\\Gamma(r)} \\int_0^\\infty \\lambda^{r+k-1} e^{-\\lambda/p} \\;\\mathrm{d}\\lambda \\\\\\\\[8pt] & = \\frac{(1-p)^r p^{-r}}{k!\\,\\Gamma(r)} \\ p^{r+k} \\, \\Gamma(r+k) \\\\\\\\[8pt] & = \\frac{\\Gamma(r+k)}{k!\\;\\Gamma(r)} \\; p^{k} (1-p)^r. \\end{align} Because of this, the negative binomial distribution is also known as the gamma\u2013Poisson (mixture) distribution. The negative binomial distribution was originally derived as a limiting case of the gamma-Poisson distribution. ===Distribution of a sum of geometrically distributed random variables=== If Yr is a random variable following the negative binomial distribution with parameters r and p, and support {0, 1, 2, ...}, then Yr is a sum of r independent variables following the geometric distribution (on {0, 1, 2, ...}) with parameter p. As a result of the central limit theorem, Yr (properly scaled and shifted) is therefore approximately normal for sufficiently large r. Furthermore, if Bs+r is a random variable following the binomial distribution with parameters s + r and 1 \u2212 p, then : \\begin{align} \\Pr(Y_r \\leq s) & {} = 1 - I_p(s+1, r) \\\\\\\\[5pt] & {} = 1 - I_{p}((s+r)-(r-1), (r-1)+1) \\\\\\\\[5pt] & {} = 1 - \\Pr(B_{s+r} \\leq r-1) \\\\\\\\[5pt] & {} = \\Pr(B_{s+r} \\geq r) \\\\\\\\[5pt] & {} = \\Pr(\\text{after } s+r \\text{ trials, there are at least } r \\text{ successes}). \\end{align} In this sense, the negative binomial distribution is the \"inverse\" of the binomial distribution. The sum of independent negative- binomially distributed random variables r1 and r2 with the same value for parameter p is negative-binomially distributed with the same p but with r-value r1 + r2. The negative binomial distribution is infinitely divisible, i.e., if Y has a negative binomial distribution, then for any positive integer n, there exist independent identically distributed random variables Y1, ..., Yn whose sum has the same distribution that Y has. ===Representation as compound Poisson distribution=== The negative binomial distribution NB(r,p) can be represented as a compound Poisson distribution: Let } denote a sequence of independent and identically distributed random variables, each one having the logarithmic distribution Log(p), with probability mass function : f(k; r, p) = \\frac{-p^k}{k\\ln(1-p)},\\qquad k\\in{\\mathbb N}. Let N be a random variable, independent of the sequence, and suppose that N has a Poisson distribution with mean . Then the random sum : X=\\sum_{n=1}^N Y_n is NB(r,p)-distributed. To prove this, we calculate the probability generating function GX of X, which is the composition of the probability generating functions GN and GY1. Using :G_N(z)=\\exp(\\lambda(z-1)),\\qquad z\\in\\mathbb{R}, and : G_{Y_1}(z)=\\frac{\\ln(1-pz)}{\\ln(1-p)},\\qquad |z|<\\frac1p, we obtain : \\begin{align}G_X(z) & =G_N(G_{Y_1}(z))\\\\\\\\[4pt] &=\\exp\\biggl(\\lambda\\biggl(\\frac{\\ln(1-pz)}{\\ln(1-p)}-1\\biggr)\\biggr)\\\\\\\\[4pt] &=\\exp\\bigl(-r(\\ln(1-pz)-\\ln(1-p))\\bigr)\\\\\\\\[4pt] &=\\biggl(\\frac{1-p}{1-pz}\\biggr)^r,\\qquad |z|<\\frac1p, \\end{align} which is the probability generating function of the NB(r,p) distribution. The following table describes four distributions related to the number of successes in a sequence of draws: {| class=\"wikitable\" |- ! !! With replacements !! No replacements |- | Given number of draws || binomial distribution || hypergeometric distribution |- | Given number of failures || negative binomial distribution || negative hypergeometric distribution |} ===(a,b,0) class of distributions=== The negative binomial, along with the Poisson and binomial distributions, is a member of the (a,b,0) class of distributions. All three of these distributions are special cases of the Panjer distribution. They are also members of the Natural exponential family. ==Statistical inference== ===Parameter estimation=== ====MVUE for p==== Suppose p is unknown and an experiment is conducted where it is decided ahead of time that sampling will continue until r successes are found. A sufficient statistic for the experiment is k, the number of failures. In estimating p, the minimum variance unbiased estimator is : \\widehat{p}=\\frac{r-1}{r+k-1}. ====Maximum likelihood estimation==== The maximum likelihood estimate of p is : \\widetilde{p}=\\frac{r}{r+k}, but this is a biased estimate. Its inverse (r + k)/r, is an unbiased estimate of 1/p, however. The maximum likelihood estimator only exists for samples for which the sample variance is larger than the sample mean. The likelihood function for N iid observations (k1, ..., kN) is :L(r,p)=\\prod_{i=1}^N f(k_i;r,p)\\,\\\\! from which we calculate the log- likelihood function :\\ell(r,p) = \\sum_{i=1}^N \\ln(\\Gamma(k_i + r)) - \\sum_{i=1}^N \\ln(k_i !) - N\\ln(\\Gamma(r)) + \\sum_{i=1}^N k_i \\ln(1-p) + Nr \\ln(p). To find the maximum we take the partial derivatives with respect to r and p and set them equal to zero: :\\frac{\\partial \\ell(r,p)}{\\partial p} = \\left[\\sum_{i=1}^N k_i \\frac{1}{p}\\right] - Nr \\frac{1}{1-p} = 0 and :\\frac{\\partial \\ell(r,p)}{\\partial r} = \\left[\\sum_{i=1}^N \\psi(k_i + r)\\right] - N\\psi(r) + N\\ln(1-p) = 0 where : \\psi(k) = \\frac{\\Gamma'(k)}{\\Gamma(k)} \\\\! is the digamma function. Solving the first equation for p gives: :p = \\frac{\\sum_{i=1}^N k_i} {Nr + \\sum_{i=1}^N k_i} Substituting this in the second equation gives: :\\frac{\\partial \\ell(r,p)}{\\partial r} = \\left[\\sum_{i=1}^N \\psi(k_i + r)\\right] - N\\psi(r) + N\\ln\\left(\\frac{r}{r + \\sum_{i=1}^N k_i/N}\\right) = 0 This equation cannot be solved for r in closed form. If a numerical solution is desired, an iterative technique such as Newton's method can be used. Alternatively, the expectation\u2013maximization algorithm can be used. ==Occurrence and applications== ===Waiting time in a Bernoulli process=== For the special case where r is an integer, the negative binomial distribution is known as the Pascal distribution. It is the probability distribution of a certain number of failures and successes in a series of independent and identically distributed Bernoulli trials. For k + r Bernoulli trials with success probability p, the negative binomial gives the probability of k successes and r failures, with a failure on the last trial. In other words, the negative binomial distribution is the probability distribution of the number of successes before the rth failure in a Bernoulli process, with probability p of successes on each trial. A Bernoulli process is a discrete time process, and so the number of trials, failures, and successes are integers. Consider the following example. Suppose we repeatedly throw a die, and consider a 1 to be a \"failure\". The probability of success on each trial is 5/6. The number of successes before the third failure belongs to the infinite set { 0, 1, 2, 3, ... }. That number of successes is a negative-binomially distributed random variable. When r = 1 we get the probability distribution of number of successes before the first failure (i.e. the probability of the first failure occurring on the (k + 1)st trial), which is a geometric distribution: : f(k; r, p) = (1-p) \\cdot p^k \\\\! ===Overdispersed Poisson=== The negative binomial distribution, especially in its alternative parameterization described above, can be used as an alternative to the Poisson distribution. It is especially useful for discrete data over an unbounded positive range whose sample variance exceeds the sample mean. In such cases, the observations are overdispersed with respect to a Poisson distribution, for which the mean is equal to the variance. Hence a Poisson distribution is not an appropriate model. Since the negative binomial distribution has one more parameter than the Poisson, the second parameter can be used to adjust the variance independently of the mean. See Cumulants of some discrete probability distributions. An application of this is to annual counts of tropical cyclones in the North Atlantic or to monthly to 6-monthly counts of wintertime extratropical cyclones over Europe, for which the variance is greater than the mean. In the case of modest overdispersion, this may produce substantially similar results to an overdispersed Poisson distribution. The negative binomial distribution is also commonly used to model data in the form of discrete sequence read counts from high-throughput RNA and DNA sequencing experiments. ==History== This distribution was first studied in 1713, by Montmort, as the distribution of the number of trials required in an experiment to obtain a given number of successes.Montmort PR de (1713) Essai d'analyse sur les jeux de hasard. 2nd ed. Quillau, Paris It had previously been mentioned by Pascal.Pascal B (1679) Varia Opera Mathematica. D. Petri de Fermat. Tolosae ==See also== * Coupon collector's problem * Beta negative binomial distribution * Extended negative binomial distribution * Negative multinomial distribution * Binomial distribution * Poisson distribution * Exponential family * Vector generalized linear model * Compound Poisson distribution == References == Category:Discrete distributions Category:Exponential family distributions Category:Compound probability distributions Category:Factorial and binomial topics Category:Infinitely divisible probability distributions ",
    "title": "Negative binomial distribution"
}