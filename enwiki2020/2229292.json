{
    "id": "2229292",
    "text": "15 partitions of a 4-element set ordered in a Hasse diagram There are S(4,1), ..., S(4, 4) = 1, 7, 6, 1 partitions containing 1, 2, 3, 4 sets. In mathematics, particularly in combinatorics, a Stirling number of the second kind (or Stirling partition number) is the number of ways to partition a set of n objects into k non-empty subsets and is denoted by S(n,k) or \\textstyle \\left\\\\{{n\\atop k}\\right\\\\}.Ronald L. Graham, Donald E. Knuth, Oren Patashnik (1988) Concrete Mathematics, Addison\u2013Wesley, Reading MA. , p. 244. Stirling numbers of the second kind occur in the field of mathematics called combinatorics and the study of partitions. Stirling numbers of the second kind are one of two kinds of Stirling numbers, the other kind being called Stirling numbers of the first kind (or Stirling cycle numbers). Mutually inverse (finite or infinite) triangular matrices can be formed from the Stirling numbers of each kind according to the parameters n, k. ==Definition== The Stirling numbers of the second kind, written S(n,k) or \\lbrace\\textstyle{n\\atop k}\\rbrace or with other notations, count the number of ways to partition a set of n labelled objects into k nonempty unlabelled subsets. Equivalently, they count the number of different equivalence relations with precisely k equivalence classes that can be defined on an n element set. In fact, there is a bijection between the set of partitions and the set of equivalence relations on a given set. Obviously, :\\left\\\\{ {n \\atop n} \\right\\\\} = 1 and for n \\geq 1, \\left\\\\{ {n \\atop 1}\\right\\\\} = 1 as the only way to partition an n-element set into n parts is to put each element of the set into its own part, and the only way to partition a nonempty set into one part is to put all of the elements in the same part. They can be calculated using the following explicit formula: :\\left\\\\{ {n \\atop k}\\right\\\\} = \\frac{1}{k!}\\sum_{i=0}^{k} (-1)^{i} \\binom{k}{i} (k-i)^n. The Stirling numbers of the second kind may also be characterized as the numbers that arise when one expresses powers of an indeterminate x in terms of the falling factorialsConfusingly, the notation that combinatorialists use for falling factorials coincides with the notation used in special functions for rising factorials; see Pochhammer symbol. :(x)_n=x(x-1)(x-2)\\cdots(x-n+1) . (In particular, (x)0 = 1 because it is an empty product.) In particular, one has :\\sum_{k=0}^n \\left\\\\{ {n \\atop k} \\right\\\\}(x)_k=x^n. ==Notation== Various notations have been used for Stirling numbers of the second kind. The brace notation \\textstyle \\lbrace{n\\atop k}\\rbrace was used by Imanuel Marx and Antonio Salmeri in 1962 for variants of these numbers.Transformation of Series by a Variant of Stirling's Numbers, Imanuel Marx, The American Mathematical Monthly 69, #6 (June\u2013July 1962), pp. 530\u2013532, .Antonio Salmeri, Introduzione alla teoria dei coefficienti fattoriali, Giornale di Matematiche di Battaglini 90 (1962), pp. 44\u201354. This led Knuth to use it, as shown here, in the first volume of The Art of Computer Programming (1968).Donald E. Knuth, Fundamental Algorithms, Reading, Mass.: Addison\u2013Wesley, 1968. However, according to the third edition of The Art of Computer Programming, this notation was also used earlier by Jovan Karamata in 1935.p. 66, Donald E. Knuth, Fundamental Algorithms, 3rd ed., Reading, Mass.: Addison\u2013Wesley, 1997.Jovan Karamata, Th\u00e9or\u00e8mes sur la sommabilit\u00e9 exponentielle et d'autres sommabilit\u00e9s s'y rattachant, Mathematica (Cluj) 9 (1935), pp, 164\u2013178. The notation S(n, k) was used by Richard Stanley in his book Enumerative Combinatorics. ==Relation to Bell numbers== Since the Stirling number \\left\\\\{ {n \\atop k} \\right\\\\} counts set partitions of an n-element set into k parts, the sum :B_n=\\sum_{k=0}^n \\left\\\\{ {n \\atop k} \\right\\\\} over all values of k is the total number of partitions of a set with n members. This number is known as the nth Bell number. Analogously, the ordered Bell numbers can be computed from the Stirling numbers of the second kind via :a_n = \\sum_{k=0}^n k! \\left\\\\{ {n \\atop k}\\right\\\\}. ==Table of values== Below is a triangular array of values for the Stirling numbers of the second kind : {| style=\"text- align:right;\" class=\"wikitable\" |- ! ! | 0 ! | 1 ! | 2 ! | 3 ! | 4 ! | 5 ! | 6 ! | 7 ! | 8 ! | 9 ! | 10 |- ! | 0 | 1 |- ! | 1 | 0 | 1 |- ! | 2 | 0 | 1 | 1 |- ! | 3 | 0 | 1 | 3 | 1 |- ! | 4 | 0 | 1 | 7 | 6 | 1 |- ! | 5 | 0 | 1 | 15 | 25 | 10 | 1 |- ! | 6 | 0 | 1 | 31 | 90 | 65 | 15 | 1 |- ! | 7 | 0 | 1 | 63 | 301 | 350 | 140 | 21 | 1 |- ! | 8 | 0 | 1 | 127 | 966 | 1701 | 1050 | 266 | 28 | 1 |- ! | 9 | 0 | 1 | 255 | 3025 | 7770 | 6951 | 2646 | 462 | 36 | 1 |- ! | 10 | 0 | 1 | 511 | 9330 | 34105 | 42525 | 22827 | 5880 | 750 | 45 | 1 |- |} As with the binomial coefficients, this table could be extended to , but those entries would all be 0\\. == Properties == ===Recurrence relation=== Stirling numbers of the second kind obey the recurrence relation :\\left\\\\{{n+1\\atop k}\\right\\\\} = k \\left\\\\{{ n \\atop k }\\right\\\\} + \\left\\\\{{n\\atop k-1}\\right\\\\} for k > 0 with initial conditions :\\left\\\\{{ 0 \\atop 0 }\\right\\\\} = 1 \\quad \\mbox{ and } \\quad \\left\\\\{{ n \\atop 0 }\\right\\\\} = \\left\\\\{{ 0 \\atop n }\\right\\\\} = 0 for n > 0. For instance, the number 25 in column k=3 and row n=5 is given by 25=7+(3\u00d76), where 7 is the number above and to the left of 25, 6 is the number above 25 and 3 is the column containing the 6. To understand this recurrence, observe that a partition of the objects into k nonempty subsets either contains the -th object as a singleton or it does not. The number of ways that the singleton is one of the subsets is given by :\\left\\\\{{ n \\atop k-1 }\\right\\\\} since we must partition the remaining objects into the available subsets. In the other case the -th object belongs to a subset containing other objects. The number of ways is given by :k \\left\\\\{{ n \\atop k }\\right\\\\} since we partition all objects other than the -th into k subsets, and then we are left with k choices for inserting object . Summing these two values gives the desired result. Some more recurrences are as follows: :\\left\\\\{{n+1\\atop k+1}\\right\\\\} = \\sum_{j=k}^n {n \\choose j} \\left\\\\{{ j \\atop k }\\right\\\\}, :\\left\\\\{{n+1\\atop k+1}\\right\\\\} = \\sum_{j=k}^n (k+1)^{n-j} \\left\\\\{{j \\atop k}\\right\\\\} , :\\left\\\\{{n+k+1 \\atop k}\\right\\\\} = \\sum_{j=0}^k j \\left\\\\{{ n+j \\atop j }\\right\\\\}. ===Lower and upper bounds=== If n \\geq 2 and 1 \\leq k \\leq n-1, then :L(n,k) \\leq \\left\\\\{{n \\atop k}\\right\\\\} \\leq U(n,k) where :L(n,k) = \\frac{1}{2}(k^2+k+2)k^{n-k-1}-1 and :U(n,k) = \\frac{1}{2}{n \\choose k} k^{n-k}. ===Maximum=== For fixed n, \\left\\\\{{n \\atop k}\\right\\\\} has a single maximum, which is attained for at most two consecutive values of k. That is, there is an integer K_n such that :\\left\\\\{{n \\atop 1}\\right\\\\} < \\left\\\\{{n \\atop 2}\\right\\\\} < \\cdots < \\left\\\\{{n \\atop K_n}\\right\\\\}, :\\left\\\\{{n \\atop K_n}\\right\\\\} \\geq \\left\\\\{{n \\atop K_n+1}\\right\\\\} > \\cdots > \\left\\\\{{n \\atop n}\\right\\\\}. When n is large :K_n \\sim \\frac{n}{\\log n}, and the maximum value of the Stirling number of second kind is :\\log \\left\\\\{{n \\atop K_n}\\right\\\\} = n\\log n - n \\log\\log n - n + O(n \\log\\log n / \\log n). ===Parity=== Parity of Stirling numbers of the second kind. The parity of a Stirling number of the second kind is equal to the parity of a related binomial coefficient: :\\left\\\\{ {n\\atop k}\\right\\\\}\\equiv \\binom{z}{w}\\ \\pmod{2}, where z = n - \\left\\lceil\\displaystyle\\frac{k + 1}{2}\\right\\rceil,\\ w = \\left\\lfloor\\displaystyle\\frac{k - 1}{2}\\right\\rfloor. This relation is specified by mapping n and k coordinates onto the Sierpi\u0144ski triangle. More directly, let two sets contain positions of 1's in binary representations of results of respective expressions: : \\begin{align} \\mathbb{A}:\\ \\sum_{i\\in\\mathbb{A}} 2^i &= n-k,\\\\\\ \\mathbb{B}:\\ \\sum_{j\\in\\mathbb{B}} 2^j &= \\left\\lfloor\\dfrac{k - 1}{2}\\right\\rfloor.\\\\\\ \\end{align} One can mimic a bitwise AND operation by intersecting these two sets: : \\begin{Bmatrix}n\\\\\\k\\end{Bmatrix}\\,\\bmod\\,2 = \\begin{cases} 0, & \\mathbb{A}\\cap\\mathbb{B} e\\empty;\\\\\\ 1, & \\mathbb{A}\\cap\\mathbb{B}=\\empty; \\end{cases} to obtain the parity of a Stirling number of the second kind in O(1) time. In pseudocode: : \\begin{Bmatrix}n\\\\\\k\\end{Bmatrix}\\,\\bmod\\,2 := \\left[\\left( \\left(n-k\\right)\\ \\And\\ \\left( \\left(k-1\\right)\\,\\mathrm{div}\\,2 \\right)\\right) = 0\\right]; where \\left[b\\right] is the Iverson bracket. ===Simple identities=== Some simple identities include :\\left\\\\{ {n \\atop n-1}\\right\\\\} = \\binom{n}{2}. This is because dividing n elements into sets necessarily means dividing it into one set of size 2 and sets of size 1. Therefore we need only pick those two elements; and :\\left\\\\{ {n \\atop 2}\\right\\\\} = 2^{n-1}-1. To see this, first note that there are 2 ordered pairs of complementary subsets A and B. In one case, A is empty, and in another B is empty, so ordered pairs of subsets remain. Finally, since we want unordered pairs rather than ordered pairs we divide this last number by 2, giving the result above. Another explicit expansion of the recurrence-relation gives identities in the spirit of the above example. : \\begin{align} \\left\\\\{ {n \\atop 2} \\right\\\\} & = \\frac{ \\frac11 (2^{n-1}-1^{n-1}) }{0!} \\\\\\\\[8pt] \\left\\\\{ {n \\atop 3} \\right\\\\} & = \\frac{ \\frac11 (3^{n-1}-2^{n-1})- \\frac12 (3^{n-1}-1^{n-1}) }{1!} \\\\\\\\[8pt] \\left\\\\{ {n \\atop 4} \\right\\\\} & = \\frac{ \\frac11 (4^{n-1}-3^{n-1})- \\frac22 (4^{n-1}-2^{n-1}) + \\frac13 (4^{n-1}-1^{n-1})}{2!} \\\\\\\\[8pt] \\left\\\\{ {n \\atop 5} \\right\\\\} & = \\frac{ \\frac11 (5^{n-1}-4^{n-1})- \\frac32 (5^{n-1}-3^{n-1}) + \\frac33 (5^{n-1}-2^{n-1}) - \\frac14 (5^{n-1}-1^{n-1}) }{3!} \\\\\\\\[8pt] & {}\\ \\ \\vdots \\end{align} These examples can be summarized by the recurrence : \\left\\lbrace\\begin{matrix} n \\\\\\ k \\end{matrix}\\right\\rbrace = \\frac{k^n}{k!}-\\sum_{r=1}^{k-1} \\frac{\\left\\lbrace\\begin{matrix} n \\\\\\ r\\end{matrix}\\right\\rbrace}{(k-r)!}. ===Explicit formula=== The Stirling numbers of the second kind are given by the explicit formula: :\\left\\\\{ {n \\atop k} \\right\\\\} =\\sum_{j=1}^k (-1)^{k-j} \\frac{j^{n-1}}{(j-1)!(k-j)!} =\\frac{1}{k!}\\sum_{j=0}^{k}(-1)^{k-j}{k \\choose j} j^n . This can be derived by using inclusion-exclusion to count the number of surjections from n to k and using the fact that the number of such surjections is k! \\left\\\\{ {n \\atop k} \\right\\\\} . Additionally, this formula is a special case of the kth forward difference of the monomial x^n evaluated at x = 0: : \\Delta^k x^n = \\sum_{j=0}^{k}(-1)^{k-j}{k \\choose j} (x+j)^n. Because the Bernoulli polynomials may be written in terms of these forward differences, one immediately obtains a relation in the Bernoulli numbers: :B_m(0)=\\sum_{k=0}^m \\frac {(-1)^k k!}{k+1} \\left\\\\{ {m \\atop k} \\right\\\\}. ===Generating functions=== For a fixed integer n, the ordinary generating function for the Stirling numbers of the second kind \\left\\\\{ {n\\atop 0} \\right\\\\}, \\left\\\\{ {n\\atop 1} \\right\\\\}, \\ldots is given by : \\sum_{k=0}^n \\left\\\\{ {n\\atop k} \\right\\\\} x^k = T_n(x), where T_n(x) are Touchard polynomials. If one sums the Stirling numbers against the falling factorial instead, one can show the following identities, among others: : \\sum_{k=0}^n \\left\\\\{ {n\\atop k} \\right\\\\} (x)_k = x^n and : \\sum_{k=1}^{n+1} \\left\\\\{ {n+1 \\atop k} \\right\\\\} (x-1)_{k-1} = x^n. For a fixed integer k, the Stirling numbers of the second kind \\left\\\\{ {0\\atop k} \\right\\\\}, \\left\\\\{ {1\\atop k} \\right\\\\}, \\ldots have rational ordinary generating function :\\sum_{n=k}^\\infty \\left\\\\{ {n\\atop k} \\right\\\\} x^{n - k} = \\prod_{r=1}^k \\frac{1}{1-rx} = \\frac{1}{(k+1)! x^{k + 1} \\binom{\\frac{1}{x}}{k+1}} and have exponential generating function given by : \\sum_{n=k}^\\infty \\left\\\\{ {n \\atop k}\\right\\\\} \\frac{x^n}{n!} = \\frac{(e^x-1)^k}{k!}. A mixed bivariate generating function for the Stirling numbers of the second kind is : \\sum_{0 \\leq k \\leq n} \\left\\\\{ {n \\atop k} \\right\\\\} \\frac{x^n}{n!} y^k = e^{y(e^x-1)}. ===Asymptotic approximation=== For fixed value of k, the asymptotic value of the Stirling numbers of the second kind as n\\rightarrow \\infty is given by : \\left\\\\{{n \\atop k}\\right\\\\} \\sim \\frac{k^n}{k!}. On the other side, if k = o(\\sqrt{n}) (where o denotes the little o notation) then : \\left\\\\{{n \\atop n-k}\\right\\\\} \\sim \\frac{(n-k)^{2k}}{2^k k!} \\left( 1 + \\frac{1}{3} \\frac{2 k^2 + k}{n-k} + \\frac{1}{18} \\frac{4k^4-k^2-3k}{(n-k)^2} + \\cdots \\right).L. C. Hsu, Note on an Asymptotic Expansion of the nth Difference of Zero, AMS Vol.19 NO.2 1948, pp. 273--277 A uniformly valid approximation also exists: for all such that , one has : \\left\\\\{{n \\atop k}\\right\\\\} \\sim \\sqrt{\\frac{v-1}{v(1-G)}} \\left(\\frac{v-1}{v-G}\\right)^{n-k} \\frac{k^n}{n^k} e^{k(1-G)} \\left({n \\atop k}\\right), where G = - W_0(-v e^{-v}), v=n/k , and W_0(z) is the main branch of the Lambert W function.N. M. Temme, Asymptotic Estimates of Stirling Numbers, STUDIES IN APPLIED MATHEMATICS 89:233-243 (1993), Elsevier Science Publishing. Relative error is bounded by about 0.066/n . ==Applications== ===Moments of the Poisson distribution=== If X is a random variable with a Poisson distribution with expected value \u03bb, then its nth moment is :E(X^n)=\\sum_{k=1}^n \\left\\\\{ {n \\atop k} \\right\\\\}\\lambda^k. In particular, the nth moment of the Poisson distribution with expected value 1 is precisely the number of partitions of a set of size n, i.e., it is the nth Bell number (this fact is Dobi\u0144ski's formula). ===Moments of fixed points of random permutations=== Let the random variable X be the number of fixed points of a uniformly distributed random permutation of a finite set of size m. Then the nth moment of X is :E(X^n) = \\sum_{k=1}^m \\left\\\\{ {n \\atop k} \\right\\\\}. Note: The upper bound of summation is m, not n. In other words, the nth moment of this probability distribution is the number of partitions of a set of size n into no more than m parts. This is proved in the article on random permutation statistics, although the notation is a bit different. ===Rhyming schemes=== The Stirling numbers of the second kind can represent the total number of rhyme schemes for a poem of n lines. S(n,k) gives the number of possible rhyming schemes for n lines using k unique rhyming syllables. As an example, for a poem of 3 lines, there is 1 rhyme scheme using just one rhyme (aaa), 3 rhyme schemes using two rhymes (aab, aba, abb), and 1 rhyme scheme using three rhymes (abc). ==Variants== ===Associated Stirling numbers of the second kind=== An r-associated Stirling number of the second kind is the number of ways to partition a set of n objects into k subsets, with each subset containing at least r elements.L. Comtet, Advanced Combinatorics, Reidel, 1974, p. 222. It is denoted by S_r(n,k) and obeys the recurrence relation :S_r(n+1, k)=k\\ S_r(n, k)+\\binom{n}{r-1}S_r(n-r+1, k-1) The 2-associated numbers appear elsewhere as \"Ward numbers\" and as the magnitudes of the coefficients of Mahler polynomials. ===Reduced Stirling numbers of the second kind=== Denote the n objects to partition by the integers 1, 2, ..., n. Define the reduced Stirling numbers of the second kind, denoted S^d(n, k), to be the number of ways to partition the integers 1, 2, ..., n into k nonempty subsets such that all elements in each subset have pairwise distance at least d. That is, for any integers i and j in a given subset, it is required that |i-j| \\geq d. It has been shown that these numbers satisfy :S^d(n, k) = S(n-d+1, k-d+1), n \\geq k \\geq d (hence the name \"reduced\").A. Mohr and T.D. Porter, Applications of Chromatic Polynomials Involving Stirling Numbers, Journal of Combinatorial Mathematics and Combinatorial Computing 70 (2009), 57\u201364. Observe (both by definition and by the reduction formula), that S^1(n, k) = S(n, k), the familiar Stirling numbers of the second kind. ==See also== * Bell number - the number of partitions of a set with n members * Stirling numbers of the first kind * Stirling polynomials * Twelvefold way * 20px Partition related number triangles ==References== * . * . * * Calculator for Stirling Numbers of the Second Kind * Set Partitions: Stirling Numbers * Category:Permutations Category:Factorial and binomial topics Category:Triangles of numbers pl:Liczby Stirlinga#Liczby Stirlinga II rodzaju ",
    "title": "Stirling numbers of the second kind"
}