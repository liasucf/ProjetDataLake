{
    "id": "819467",
    "text": "Fisher's exact test is a statistical significance test used in the analysis of contingency tables. Although in practice it is employed when sample sizes are small, it is valid for all sample sizes. It is named after its inventor, Ronald Fisher, and is one of a class of exact tests, so called because the significance of the deviation from a null hypothesis (e.g., P-value) can be calculated exactly, rather than relying on an approximation that becomes exact in the limit as the sample size grows to infinity, as with many statistical tests. Fisher is said to have devised the test following a comment from Muriel Bristol, who claimed to be able to detect whether the tea or the milk was added first to her cup. He tested her claim in the \"lady tasting tea\" experiment. ==Purpose and scope== A teapot, a creamer and teacup full of tea with milk\u2014can a taster tell if the milk went in first? The test is useful for categorical data that result from classifying objects in two different ways; it is used to examine the significance of the association (contingency) between the two kinds of classification. So in Fisher's original example, one criterion of classification could be whether milk or tea was put in the cup first; the other could be whether Bristol thinks that the milk or tea was put in first. We want to know whether these two classifications are associated\u2014that is, whether Bristol really can tell whether milk or tea was poured in first. Most uses of the Fisher test involve, like this example, a 2 \u00d7 2 contingency table. The p-value from the test is computed as if the margins of the table are fixed, i.e. as if, in the tea-tasting example, Bristol knows the number of cups with each treatment (milk or tea first) and will therefore provide guesses with the correct number in each category. As pointed out by Fisher, this leads under a null hypothesis of independence to a hypergeometric distribution of the numbers in the cells of the table. With large samples, a chi-squared test (or better yet, a G-test) can be used in this situation. However, the significance value it provides is only an approximation, because the sampling distribution of the test statistic that is calculated is only approximately equal to the theoretical chi-squared distribution. The approximation is inadequate when sample sizes are small, or the data are very unequally distributed among the cells of the table, resulting in the cell counts predicted on the null hypothesis (the \u201cexpected values\u201d) being low. The usual rule of thumb for deciding whether the chi-squared approximation is good enough is that the chi-squared test is not suitable when the expected values in any of the cells of a contingency table are below 5, or below 10 when there is only one degree of freedom (this rule is now known to be overly conservative). In fact, for small, sparse, or unbalanced data, the exact and asymptotic p-values can be quite different and may lead to opposite conclusions concerning the hypothesis of interest.Mehta, C. R. 1995. SPSS 6.1 Exact test for Windows. Englewood Cliffs, NJ: Prentice Hall. In contrast the Fisher exact test is, as its name states, exact as long as the experimental procedure keeps the row and column totals fixed, and it can therefore be used regardless of the sample characteristics. It becomes difficult to calculate with large samples or well-balanced tables, but fortunately these are exactly the conditions where the chi-squared test is appropriate. For hand calculations, the test is only feasible in the case of a 2 \u00d7 2 contingency table. However the principle of the test can be extended to the general case of an m \u00d7 n table,mathworld.wolfram.com Page giving the formula for the general form of Fisher's exact test for m \u00d7 n contingency tables and some statistical packages provide a calculation (sometimes using a Monte Carlo method to obtain an approximation) for the more general case. ==Example== For example, a sample of teenagers might be divided into male and female on the one hand, and those that are and are not currently studying for a statistics exam on the other. We hypothesize, for example, that the proportion of studying individuals is higher among the women than among the men, and we want to test whether any difference of proportions that we observe is significant. The data might look like this: {|class=\"wikitable\" style=\"text-align:center;\" |- ! ! Men ! Women |Row total |- !scope=\"row\" | Studying |bgcolor=\"lightgray\" | 1 ||bgcolor=\"lightgray\" | 9 || 10 |- !scope=\"row\"| Not-studying |bgcolor=\"lightgray\" | 11 ||bgcolor=\"lightgray\" | 3 || 14 |- | Column total | 12 || 12 || 24 |} The question we ask about these data is: knowing that 10 of these 24 teenagers are studying, and that 12 of the 24 are female, and assuming the null hypothesis that men and women are equally likely to study, what is the probability that these 10 teenagers who are studying would be so unevenly distributed between the women and the men? If we were to choose 10 of the teenagers at random, what is the probability that 9 or more of them would be among the 12 women, and only 1 or fewer from among the 12 men? Before we proceed with the Fisher test, we first introduce some notations. We represent the cells by the letters a, b, c and d, call the totals across rows and columns marginal totals, and represent the grand total by n. So the table now looks like this: {|class=\"wikitable\" style=\"text- align:center;\" |- ! ! Men ! Women |Row Total |- !scope=\"row\" | Studying |bgcolor=\"lightgray\" | a ||bgcolor=\"lightgray\" | b || a + b |- !scope=\"row\"| Non-studying |bgcolor=\"lightgray\" | c ||bgcolor=\"lightgray\" | d || c + d |- | Column Total | a + c || b + d || a + b + c + d (=n) |} Fisher showed that the probability of obtaining any such set of values was given by the hypergeometric distribution: p = \\frac{ \\displaystyle{{a+b}\\choose{a}} \\displaystyle{{c+d}\\choose{c}} }{ \\displaystyle{{n}\\choose{a+c}} } = \\frac{ \\displaystyle{{a+b}\\choose{b}} \\displaystyle{{c+d}\\choose{d}} }{ \\displaystyle{{n}\\choose{b+d}} } = \\frac{(a+b)!~(c+d)!~(a+c)!~(b+d)!}{a!~~b!~~c!~~d!~~n!} where \\tbinom nk is the binomial coefficient and the symbol ! indicates the factorial operator. This can be seen as follows. If the marginal totals (i.e. a+b, c+d, a+c, and b+d) are known, only a single degree of freedom is left: the value e.g. of a suffices to deduce the other values. Now, p=p(a) is the probability that a elements are positive in a random selection (without replacement) of a+c elements from a larger set containing n elements in total out of which a+b are positive, which is precisely the definition of the hypergeometric distribution. With the data above (using the first of the equivalent forms), this gives: p = { {\\tbinom{10}{1}} {\\tbinom{14}{11}} }/{ {\\tbinom{24}{12}} } = \\tfrac{10!~14!~12!~12!}{1!~9!~11!~3!~24!} \\approx 0.001346076 The formula above gives the exact hypergeometric probability of observing this particular arrangement of the data, assuming the given marginal totals, on the null hypothesis that men and women are equally likely to be studiers. To put it another way, if we assume that the probability that a man is a studier is \\mathfrak{p}, the probability that a woman is a studier is also \\mathfrak{p}, and we assume that both men and women enter our sample independently of whether or not they are studiers, then this hypergeometric formula gives the conditional probability of observing the values a, b, c, d in the four cells, conditionally on the observed marginals (i.e., assuming the row and column totals shown in the margins of the table are given). This remains true even if men enter our sample with different probabilities than women. The requirement is merely that the two classification characteristics\u2014gender, and studier (or not)\u2014are not associated. For example, suppose we knew probabilities P, Q, \\mathfrak{p,q} with P + Q = \\mathfrak{p} + \\mathfrak{q} = 1 such that (male studier, male non-studier, female studier, female non-studier) had respective probabilities (P\\mathfrak{p}, P\\mathfrak{q}, Q\\mathfrak{p}, Q\\mathfrak{q}) for each individual encountered under our sampling procedure. Then still, were we to calculate the distribution of cell entries conditional given marginals, we would obtain the above formula in which neither \\mathfrak{p} nor P occurs. Thus, we can calculate the exact probability of any arrangement of the 24 teenagers into the four cells of the table, but Fisher showed that to generate a significance level, we need consider only the cases where the marginal totals are the same as in the observed table, and among those, only the cases where the arrangement is as extreme as the observed arrangement, or more so. (Barnard's test relaxes this constraint on one set of the marginal totals.) In the example, there are 11 such cases. Of these only one is more extreme in the same direction as our data; it looks like this: {|class=\"wikitable\" style=\"text-align:center;\" |- ! ! Men ! Women |Row Total |- !scope=\"row\" | Studying |bgcolor=\"lightgray\" | 0 ||bgcolor=\"lightgray\" | 10 || 10 |- !scope=\"row\"| Non-studying |bgcolor=\"lightgray\" | 12 ||bgcolor=\"lightgray\" | 2 || 14 |- | Column Total | 12 || 12 || 24 |} For this table (with extremely unequal studying proportions) the probability is {p = {\\tbinom{10}{0}} {\\tbinom{14}{12}} }/{ {\\tbinom{24}{12}} } \\approx 0.000033652. In order to calculate the significance of the observed data, i.e. the total probability of observing data as extreme or more extreme if the null hypothesis is true, we have to calculate the values of p for both these tables, and add them together. This gives a one-tailed test, with p approximately 0.001346076 + 0.000033652 = 0.001379728. For example, in the R statistical computing environment, this value can be obtained as `fisher.test(rbind(c(1,9),c(11,3)), alternative=\"less\")$p.value`. This value can be interpreted as the sum of evidence provided by the observed data\u2014or any more extreme table\u2014for the null hypothesis (that there is no difference in the proportions of studiers between men and women). The smaller the value of p, the greater the evidence for rejecting the null hypothesis; so here the evidence is strong that men and women are not equally likely to be studiers. For a two-tailed test we must also consider tables that are equally extreme, but in the opposite direction. Unfortunately, classification of the tables according to whether or not they are 'as extreme' is problematic. An approach used by the `fisher.test` function in R is to compute the p-value by summing the probabilities for all tables with probabilities less than or equal to that of the observed table. In the example here, the 2-sided p-value is twice the 1-sided value\u2014but in general these can differ substantially for tables with small counts, unlike the case with test statistics that have a symmetric sampling distribution. As noted above, most modern statistical packages will calculate the significance of Fisher tests, in some cases even where the chi- squared approximation would also be acceptable. The actual computations as performed by statistical software packages will as a rule differ from those described above, because numerical difficulties may result from the large values taken by the factorials. A simple, somewhat better computational approach relies on a gamma function or log-gamma function, but methods for accurate computation of hypergeometric and binomial probabilities remains an active research area. ==Controversies== Despite the fact that Fisher's test gives exact p-values, some authors have argued that it is conservative, i.e. that its actual rejection rate is below the nominal significance level. The apparent contradiction stems from the combination of a discrete statistic with fixed significance levels. To be more precise, consider the following proposal for a significance test at the 5%-level: reject the null hypothesis for each table to which Fisher's test assigns a p-value equal to or smaller than 5%. Because the set of all tables is discrete, there may not be a table for which equality is achieved. If \\alpha_e is the largest p-value smaller than 5% which can actually occur for some table, then the proposed test effectively tests at the \\alpha_e-level. For small sample sizes, \\alpha_e might be significantly lower than 5%. While this effect occurs for any discrete statistic (not just in contingency tables, or for Fisher's test), it has been argued that the problem is compounded by the fact that Fisher's test conditions on the marginals. To avoid the problem, many authors discourage the use of fixed significance levels when dealing with discrete problems. The decision to condition on the margins of the table is also controversial. ; The p-values derived from Fisher's test come from the distribution that conditions on the margin totals. In this sense, the test is exact only for the conditional distribution and not the original table where the margin totals may change from experiment to experiment. It is possible to obtain an exact p-value for the 2\u00d72 table when the margins are not held fixed. Barnard's test, for example, allows for random margins. However, some authors (including, later, Barnard himself) have criticized Barnard's test based on this property. They argue that the marginal success total is an (almost) ancillary statistic, containing (almost) no information about the tested property. The act of conditioning on the marginal success rate from a 2\u00d72 table can be shown to ignore some information in the data about the unknown odds ratio. The argument that the marginal totals are (almost) ancillary implies that the appropriate likelihood function for making inferences about this odds ratio should be conditioned on the marginal success rate. Whether this lost information is important for inferential purposes is the essence of the controversy. ==Alternatives== An alternative exact test, Barnard's exact test, has been developed and proponents of it suggest that this method is more powerful, particularly in 2\u00d72 tables. Furthermore, Boschloo's test is an exact test that is uniformly more powerful than Fisher's exact test by construction. Another alternative is to use maximum likelihood estimates to calculate a p-value from the exact binomial or multinomial distributions and reject or fail to reject based on the p-value. For stratified categorical data the Cochran\u2013Mantel\u2013Haenszel test must be used instead of Fisher's test. Choi et al. propose a p-value derived from the likelihood ratio test based on the conditional distribution of the odds ratio given the marginal success rate. This p-value is inferentially consistent with classical tests of normally distributed data as well as with likelihood ratios and support intervals based on this conditional likelihood function. It is also readily computable. See also: Likelihood Ratio Statistics for 2 x 2 Tables (Online calculator). ==See also== * Bernoulli trial * Boschloo's test ==References== ==External links== * Calculate Fisher's Exact Test Online * Likelihood Ratio Statistics for 2X2 Tables Category:Statistical tests for contingency tables Category:Nonparametric statistics ",
    "title": "Fisher's exact test"
}