{
    "id": "7849883",
    "text": "In statistics, Welch's t-test, or unequal variances t-test, is a two-sample location test which is used to test the hypothesis that two populations have equal means. It is named for its creator, Bernard Lewis Welch, and is an adaptation of Student's t-test, and is more reliable when the two samples have unequal variances and/or unequal sample sizes. These tests are often referred to as \"unpaired\" or \"independent samples\" t-tests, as they are typically applied when the statistical units underlying the two samples being compared are non-overlapping. Given that Welch's t-test has been less popular than Student's t-test and may be less familiar to readers, a more informative name is \"Welch's unequal variances t-test\" \u2014 or \"unequal variances t-test\" for brevity. ==Assumptions== Student's t-test assumes that the two population(being compared) distributions are normally distributed with equal variance. Welch's t-test is designed for unequal sample distribution variance, but the assumption of sample distribution normality is maintained. Welch's t-test is an approximate solution to the Behrens\u2013Fisher problem. ==Calculations== Welch's t-test defines the statistic t by the following formula: : t \\quad = \\quad {\\; \\overline{X}_1 - \\overline{X}_2 \\; \\over \\sqrt{ \\; {s_1^2 \\over N_1} \\; + \\; {s_2^2 \\over N_2} \\quad }}\\, where \\overline{X}_j, s_j and N_j are the j^{th} sample mean, sample standard deviation and sample size, respectively, j \\in \\\\{1,2\\\\}. Unlike in Student's t-test, the denominator is not based on a pooled variance estimate. The degrees of freedom u associated with this variance estimate is approximated using the Welch\u2013Satterthwaite equation: : u \\quad \\approx \\quad {{\\left( \\; {s_1^2 \\over N_1} \\; + \\; {s_2^2 \\over N_2} \\; \\right)^2 } \\over { \\quad {s_1^4 \\over N_1^2 u_1} \\; + \\; {s_2^4 \\over N_2^2 u_2 } \\quad }} Here u_1 = N_1-1, the degrees of freedom associated with the first variance estimate. u_2 = N_2-1, the degrees of freedom associated with the 2nd variance estimate. The statistic is approximately from the t-distribution since we have an approximation of the chi-square distribution. This approximation is better done when both N_1 and N_2 are larger than 5.The Satterthwaite Formula for Degrees of Freedom in the Two-Sample t-Test (page 7)Yates, Moore, and Starnes, The Practice of Statistics, 3rd ed., p. 792. Copyright 2008 by W.H. Freeman and Company, 41 Madison Avenue, New York, NY 10010 ==Statistical test== Once t and u have been computed, these statistics can be used with the t-distribution to test one of two possible null hypotheses: * that the two population means are equal, in which a two-tailed test is applied; or * that one of the population means is greater than or equal to the other, in which a one-tailed test is applied. The approximate degrees of freedom are rounded down to the nearest integer. ==Advantages and limitations== Welch's t-test is more robust than Student's t-test and maintains type I error rates close to nominal for unequal variances and for unequal sample sizes under normality. Furthermore, the power of Welch's t-test comes close to that of Student's t-test, even when the population variances are equal and sample sizes are balanced. Welch's t-test can be generalized to more than 2-samples, which is more robust than one-way analysis of variance (ANOVA). It is not recommended to pre-test for equal variances and then choose between Student's t-test or Welch's t-test. Rather, Welch's t-test can be applied directly and without any substantial disadvantages to Student's t-test as noted above. Welch's t-test remains robust for skewed distributions and large sample sizes. Reliability decreases for skewed distributions and smaller samples, where one could possibly perform Welch's t-test. ==Examples== The following three examples compare Welch's t-test and Student's t-test. Samples are from random normal distributions using the R programming language. For all three examples, the population means were \\mu_1 = 20 and \\mu_2 = 22. The first example is for equal variances (\\sigma_1^2 = \\sigma_2^2 = 4) and equal sample sizes (N_1 = N_2 = 15). Let A1 and A2 denote two random samples: : A_1 = \\\\{27.5, 21.0, 19.0, 23.6, 17.0, 17.9, 16.9, 20.1, 21.9, 22.6, 23.1, 19.6, 19.0, 21.7, 21.4\\\\} : A_2 = \\\\{27.1, 22.0, 20.8, 23.4, 23.4, 23.5, 25.8, 22.0, 24.8, 20.2, 21.9, 22.1, 22.9, 20.5, 24.4\\\\} The second example is for unequal variances (\\sigma_1^2 = 16, \\sigma_2^2 = 1) and unequal sample sizes (N_1 = 10, N_2 = 20). The smaller sample has the larger variance: : \\begin{align} A_1 &= \\\\{17.2, 20.9, 22.6, 18.1, 21.7, 21.4, 23.5, 24.2, 14.7, 21.8\\\\} \\\\\\ A_2 &= \\\\{21.5, 22.8, 21.0, 23.0, 21.6, 23.6, 22.5, 20.7, 23.4, 21.8, 20.7, 21.7, 21.5, 22.5, 23.6, 21.5, 22.5, 23.5, 21.5, 21.8\\\\} \\end{align} The third example is for unequal variances (\\sigma_1^2 = 1, \\sigma_2^2 = 16) and unequal sample sizes (N_1 = 10, N_2 = 20). The larger sample has the larger variance: : \\begin{align} A_1 &= \\\\{19.8, 20.4, 19.6, 17.8, 18.5, 18.9, 18.3, 18.9, 19.5, 22.0\\\\} \\\\\\ A_2 &= \\\\{28.2, 26.6, 20.1, 23.3, 25.2, 22.1, 17.7, 27.6, 20.6, 13.7, 23.2, 17.5, 20.6, 18.0, 23.9, 21.6, 24.3, 20.4, 24.0, 13.2\\\\} \\end{align} Reference p-values were obtained by simulating the distributions of the t statistics for the null hypothesis of equal population means (\\mu_1 - \\mu_2 =0). Results are summarised in the table below, with two-tailed p-values: {| cellpadding=\"5\" style=\"margin:auto;\" class=\"wikitable\" |- !| ! colspan=\"3\" style=\"text-align:center;\"| Sample A1 ! colspan=\"3\" style=\"text- align:center;\"| Sample A2 ! colspan=\"4\" style=\"text-align:center;\"| Student's t-test ! colspan=\"4\" style=\"text-align:center;\"| Welch's t-test |- ! style=\"text-align:center;\"| Example ! style=\"text-align:center;\"| N_1 || style=\"text-align:center;\"| \\overline{X}_1 || style=\"text-align:center;\"| s_1^2 ! style=\"text-align:center;\"| N_2 || style=\"text-align:center;\"| \\overline{X}_2 || style=\"text-align:center;\"| s_2^2 ! style=\"text- align:center;\"| || style=\"text-align:center;\"| || style=\"text-align:center;\"| || style=\"text-align:center;\"| P_\\mathrm{sim} ! style=\"text-align:center;\"| || style=\"text-align:center;\"| || style=\"text-align:center;\"| || style=\"text- align:center;\"| P_\\mathrm{sim} |- | 1 || 15 || 20.8 || 7.9 || 15 || 23.0 || 3.8 || \u22122.46 || 28 || 0.021 || 0.021 || \u22122.46 || 25.0 || 0.021 || 0.017 |- | 2 || 10 || 20.6 || 9.0 || 20 || 22.1 || 0.9 || \u22122.10 || 28 || 0.045 || 0.150 || \u22121.57 || 9.9 || 0.149 || 0.144 |- | 3 || 10 || 19.4 || 1.4 || 20 || 21.6 || 17.1 || \u22121.64 || 28 || 0.110 || 0.036 || \u22122.22 || 24.5 || 0.036 || 0.042 |} Welch's t-test and Student's t-test gave identical results when the two samples have identical variances and sample sizes (Example 1). But note that if you sample data from populations with identical variances, the sample variances will differ, as will the results of the two t-tests. So with actual data, the two tests will almost always give somewhat different results. For unequal variances, Student's t-test gave a low p-value when the smaller sample had a larger variance (Example 2) and a high p-value when the larger sample had a larger variance (Example 3). For unequal variances, Welch's t-test gave p-values close to simulated p-values. ==Software implementations== {| class=\"wikitable sortable\" |- ! Language/Program !! Function !! Documentation |- | LibreOffice || `TTEST(Data1; Data2; Mode; Type)` || https://help.libreoffice.org/Calc/Statistical_Functions_Part_Five#TTEST |- | MATLAB || `ttest2(data1, data2, 'Vartype', 'unequal')` || http://uk.mathworks.com/help/stats/ttest2.html |- | Microsoft Excel pre 2010 || `TTEST(array1, array2, tails, type)` || http://office.microsoft.com/en- us/excel-help/ttest-HP005209325.aspx |- | Microsoft Excel 2010 and later || `T.TEST(array1, array2, tails, type)` || http://office.microsoft.com/en- us/excel-help/t-test-function-HA102753135.aspx |- | Minitab || Accessed through menu || Overview for 2-Sample t - Minitab: \u2014 official documentation for Minitab version 18. Accessed 2020-09-19. |- | SAS (Software) || Default output from `proc ttest` (labeled \"Satterthwaite\") |- | Python || `scipy.stats.ttest_ind(a, b, equal_var=False)` || http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.ttest_ind.html |- | R || `t.test(data1, data2, alternative=\"two.sided\", var.equal=FALSE)` || https://stat.ethz.ch/R-manual/R-devel/library/stats/html/t.test.html |- | Haskell || `Statistics.Test.StudentT.welchTTest SamplesDiffer data1 data2` || http://hackage.haskell.org/package/statistics-0.15.0.0/docs/Statistics-Test- StudentT.html |- | JMP || ` Oneway( Y( YColumn), X( XColumn), Unequal Variances( 1 ) );` || https://www.jmp.com/support/help/ |- | Julia || ` UnequalVarianceTTest(data1, data2)` || http://hypothesistestsjl.readthedocs.org/en/latest/index.html |- |Stata |`ttest varname1 == varname2, welch` | http://www.stata.com/help.cgi?ttest |- |Google Sheets |`TTEST(range1, range2, tails, type)` | https://support.google.com/docs/answer/6055837?hl=en |- |GraphPad Prism |It is a choice on the t test dialog. |- |IBM SPSS Statistics || An option in the menu ||Jeremy Miles: Unequal variances t-test or U Mann-Whitney test?, Accessed 2014-04-11One-Sample Test \u2014 Official documentation for SPSS Statistics version 24. Accessed 2019-01-22. |- |GNU Octave |`welch_test(x, y)` |https://octave.sourceforge.io/statistics/function/welch_test.html |} ==See also== * Student's t-test * Z-test * Factorial experiment * One-way analysis of variance * Hotelling's two-sample T-squared statistic, a multivariate extension of Welch's t-test ==References== Category:Statistical approximations Category:Statistical tests ",
    "title": "Welch's t-test"
}